import{_ as r}from"./ValaxyMain.vue_vue_type_style_index_0_lang-Xt2iGFQZ.js";import{_ as y,c as i,w as o,u as D,p as E,o as d,b as s,d as l,e,a as h,r as t,f as u}from"./app-V7sBZOCc.js";import"./YunFooter.vue_vue_type_script_setup_true_lang-T2UOmm0n.js";import"./YunCard.vue_vue_type_script_setup_true_lang-9KLhSeC6.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-ZA6nJ4XU.js";import"./index-nlSmcLJj.js";const c=JSON.parse('{"title":"使用Python写一个Telegram bot吧|Telegram bot教程","description":"","frontmatter":{"categories":"小技术","date":"2022-12-20T10:22:19.000Z","layout":"post","tags":["Python","telegram","bot","代码"],"title":"使用Python写一个Telegram bot吧|Telegram bot教程","updated":"2024-01-14T09:13:19.000Z"},"headers":[{"level":2,"title":"前言","slug":"前言","link":"#前言","children":[]},{"level":2,"title":"准备","slug":"准备","link":"#准备","children":[{"level":3,"title":"环境搭建","slug":"环境搭建","link":"#环境搭建","children":[]},{"level":3,"title":"bot 申请","slug":"bot-申请","link":"#bot-申请","children":[]},{"level":3,"title":"获取你的 id","slug":"获取你的-id","link":"#获取你的-id","children":[]}]},{"level":2,"title":"编程","slug":"编程","link":"#编程","children":[{"level":3,"title":"开始:响应/start","slug":"开始-响应-start","link":"#开始-响应-start","children":[]},{"level":3,"title":"授予群成员头衔","slug":"授予群成员头衔","link":"#授予群成员头衔","children":[]},{"level":3,"title":"响应未知命令","slug":"响应未知命令","link":"#响应未知命令","children":[]},{"level":3,"title":"简单的关键词回复","slug":"简单的关键词回复","link":"#简单的关键词回复","children":[]}]},{"level":2,"title":"部署","slug":"部署","link":"#部署","children":[{"level":3,"title":"Docker 本地构建","slug":"docker-本地构建","link":"#docker-本地构建","children":[]},{"level":3,"title":"使用 GitHub action 自动构建","slug":"使用-github-action-自动构建","link":"#使用-github-action-自动构建","children":[]}]}],"relativePath":"pages/posts/tg-bot-dev-note-kmua.md","path":"/home/runner/work/blog-source-valaxy/blog-source-valaxy/pages/posts/tg-bot-dev-note-kmua.md","lastUpdated":1705983598000}'),_={name:"pages/posts/tg-bot-dev-note-kmua.md",data(){return{data:c,frontmatter:c.frontmatter,$frontmatter:c.frontmatter}},setup(){const a=D();a.meta.frontmatter=Object.assign(a.meta.frontmatter||{},c.frontmatter||{}),E("pageData",c)}},A={class:"info custom-block"},m=s("p",{class:"custom-block-title"},[s("span",{lang:"en"},"INFO"),s("span",{lang:"zh-CN"},"信息")],-1),g=s("p",null,"2024-01-14 更新:",-1),f=s("p",null,"修复了一些错误, 删除了一些不必要的内容",-1),C={id:"前言",tabindex:"-1"},b=s("p",null,[s("s",null,"为了激发群友们水群的积极性，"),l(" 为了学习和应用 python 知识，我最近在开发一个 telegram 的 bot，所以写这篇文章以记录和分享")],-1),k=s("p",null,"本文不是从零开始的教程，阅读本文前，你需要具有一点点(真的很少一点)的 python 或其他语言编程的基础。",-1),x={id:"准备",tabindex:"-1"},v={id:"环境搭建",tabindex:"-1"},T=s("p",null,[l("使用你喜欢的工具创建虚拟环境，并安装 "),s("code",null,"python-telegram-bot"),l(" 库")],-1),w=s("div",{class:"language-shell"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"shell"),s("pre",{class:"shiki material-theme-darker vp-code-dark"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#FFCB6B"}},"pip"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"install"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"python-telegram-bot")])])]),s("pre",{class:"shiki github-light vp-code-light"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6F42C1"}},"pip"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#032F62"}},"install"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#032F62"}},"python-telegram-bot")])])]),s("button",{class:"collapse"})],-1),P={id:"bot-申请",tabindex:"-1"},U=s("code",null,"/newbot",-1),O=s("strong",null,"API Token",-1),H={id:"获取你的-id",tabindex:"-1"},N=s("strong",null,"user_id",-1),B=s("code",null,"/id",-1),M={id:"编程",tabindex:"-1"},R={id:"开始-响应-start",tabindex:"-1"},$=s("p",null,[l("在项目文件夹内，新建 "),s("code",null,"bot.py"),l("，开始编写 bot 最基础的功能，让其响应 /start 命令")],-1),Y=s("p",null,"首先，导入包",-1),K=s("div",{class:"language-python"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"python"),s("pre",{class:"shiki material-theme-darker vp-code-dark"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"from"),s("span",{style:{color:"#EEFFFF"}}," telegram "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"import"),s("span",{style:{color:"#EEFFFF"}}," Update")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"from"),s("span",{style:{color:"#EEFFFF"}}," telegram"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#EEFFFF"}},"ext "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"import"),s("span",{style:{color:"#EEFFFF"}}," ApplicationBuilder"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#EEFFFF"}}," ContextTypes"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#EEFFFF"}}," CommandHandler")])])]),s("pre",{class:"shiki github-light vp-code-light"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"from"),s("span",{style:{color:"#24292E"}}," telegram "),s("span",{style:{color:"#D73A49"}},"import"),s("span",{style:{color:"#24292E"}}," Update")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"from"),s("span",{style:{color:"#24292E"}}," telegram.ext "),s("span",{style:{color:"#D73A49"}},"import"),s("span",{style:{color:"#24292E"}}," ApplicationBuilder, ContextTypes, CommandHandler")])])]),s("button",{class:"collapse"})],-1),L=s("p",null,'Update 类是从 Telegram 服务器获取到的各种"更新", 包括而不限于用户发送的消息, 群组的信息变化等.',-1),S=s("p",null,"然后，写一个异步函数 start()，当收到 /start 命令时，要调用它。",-1),I=s("div",{class:"language-python"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"python"),s("pre",{class:"shiki material-theme-darker vp-code-dark"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"async"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C792EA"}},"def"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#82AAFF"}},"start"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"update"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," Update"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"context"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," ContextTypes"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"DEFAULT_TYPE"),s("span",{style:{color:"#89DDFF"}},"):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"'''"),s("span",{style:{color:"#545454","font-style":"italic"}},"响应start命令"),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"'''")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    text "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"你好~我是一个bot"),s("span",{style:{color:"#89DDFF"}},"'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"await"),s("span",{style:{color:"#EEFFFF"}}," context"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"bot"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"send_message"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"chat_id"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"update"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"effective_chat"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"id"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"text"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"text"),s("span",{style:{color:"#89DDFF"}},")")])])]),s("pre",{class:"shiki github-light vp-code-light"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"async"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"def"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"start"),s("span",{style:{color:"#24292E"}},"(update: Update, context: ContextTypes."),s("span",{style:{color:"#005CC5"}},"DEFAULT_TYPE"),s("span",{style:{color:"#24292E"}},"):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#032F62"}},"'''响应start命令'''")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    text "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#032F62"}},"'你好~我是一个bot'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"await"),s("span",{style:{color:"#24292E"}}," context.bot.send_message("),s("span",{style:{color:"#E36209"}},"chat_id"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"update.effective_chat.id,"),s("span",{style:{color:"#E36209"}},"text"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"text)")])])]),s("button",{class:"collapse"})],-1),j=s("p",null,[l("这个函数接受两个参数 "),s("code",null,"update"),l(" 和 "),s("code",null,"context"),l("，形参冒号后是类型注解。")],-1),G=s("p",null,[s("code",null,"context.bot.send_message()"),l(" 方法即为让 bot 发送消息，它能接受的参数其实很多，但是往往只需要 "),s("code",null,"chat_id"),l(" ，和 "),s("code",null,"text"),l(" 就够了，它们分别表示 要发送消息给的用户或群组 id ，要发送的文本。")],-1),Z=s("p",null,[l("而 "),s("code",null,"update.effective_chat.id"),l(" 即为当前有效对话的 id ，bot 收到的是哪里的消息 ，它就指向哪里的 id。")],-1),q=s("p",null,"现在，添加一个处理器(handler)",-1),V=s("div",{class:"language-python"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"python"),s("pre",{class:"shiki material-theme-darker vp-code-dark"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"start_handler "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#82AAFF"}},"CommandHandler"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"start"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," start"),s("span",{style:{color:"#89DDFF"}},")")])])]),s("pre",{class:"shiki github-light vp-code-light"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"start_handler "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," CommandHandler("),s("span",{style:{color:"#032F62"}},"'start'"),s("span",{style:{color:"#24292E"}},", start)")])])]),s("button",{class:"collapse"})],-1),W=s("p",null,[s("code",null,"CommandHandler"),l(" 类可以实现当收到某个命令时，调用某个函数（命令和函数名可以不一样），我们将其实例化为了 "),s("code",null,"start_handler"),l(" ，并且将命令名字 'start' 和对应要回调的函数名 "),s("code",null,"start"),l(" 传递给它")],-1),X=s("p",null,"然后，启动bot",-1),z=s("div",{class:"language-python"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"python"),s("pre",{class:"shiki material-theme-darker vp-code-dark"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#545454","font-style":"italic"}},"# 构建 bot")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"TOEKN"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"你 bot 的 api token"),s("span",{style:{color:"#89DDFF"}},"'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"application "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#82AAFF"}},"ApplicationBuilder"),s("span",{style:{color:"#89DDFF"}},"()."),s("span",{style:{color:"#82AAFF"}},"token"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"TOKEN"),s("span",{style:{color:"#89DDFF"}},")."),s("span",{style:{color:"#82AAFF"}},"build"),s("span",{style:{color:"#89DDFF"}},"()")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#545454","font-style":"italic"}},"# 注册 handler")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"application"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"add_handler"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"start_handler"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#545454","font-style":"italic"}},"# run!")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"application"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"run_polling"),s("span",{style:{color:"#89DDFF"}},"()")])])]),s("pre",{class:"shiki github-light vp-code-light"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# 构建 bot")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#005CC5"}},"TOEKN"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#032F62"}},"'你 bot 的 api token'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"application "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," ApplicationBuilder().token("),s("span",{style:{color:"#005CC5"}},"TOKEN"),s("span",{style:{color:"#24292E"}},").build()")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# 注册 handler")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"application.add_handler(start_handler)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# run!")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"application.run_polling()")])])]),s("button",{class:"collapse"})],-1),Q=s("p",null,[l("最后，就可以使用 "),s("code",null,"python bot.py"),l(" 启动你的 bot ，对 bot 发送 /start ，它应该就会回复你 ”你好~我是一个bot”。 使用 Ctrl + C 结束程序运行。")],-1),J=s("p",null,"上述完整代码:",-1),ss=s("div",{class:"language-python"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"python"),s("pre",{class:"shiki material-theme-darker vp-code-dark"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"from"),s("span",{style:{color:"#EEFFFF"}}," telegram "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"import"),s("span",{style:{color:"#EEFFFF"}}," Update")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"from"),s("span",{style:{color:"#EEFFFF"}}," telegram"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#EEFFFF"}},"ext "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"import"),s("span",{style:{color:"#EEFFFF"}}," ApplicationBuilder"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#EEFFFF"}}," ContextTypes"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#EEFFFF"}}," CommandHandler")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"async"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C792EA"}},"def"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#82AAFF"}},"start"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"update"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," Update"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"context"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," ContextTypes"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"DEFAULT_TYPE"),s("span",{style:{color:"#89DDFF"}},"):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"'''"),s("span",{style:{color:"#545454","font-style":"italic"}},"响应start命令"),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"'''")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    text "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"你好~我是一个bot"),s("span",{style:{color:"#89DDFF"}},"'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"await"),s("span",{style:{color:"#EEFFFF"}}," context"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"bot"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"send_message"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"chat_id"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"update"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"effective_chat"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"id"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"text"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"text"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"start_handler "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#82AAFF"}},"CommandHandler"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"start"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," start"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#545454","font-style":"italic"}},"# 构建 bot")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"TOEKN"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"你 bot 的 api token"),s("span",{style:{color:"#89DDFF"}},"'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"application "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#82AAFF"}},"ApplicationBuilder"),s("span",{style:{color:"#89DDFF"}},"()."),s("span",{style:{color:"#82AAFF"}},"token"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"TOKEN"),s("span",{style:{color:"#89DDFF"}},")."),s("span",{style:{color:"#82AAFF"}},"build"),s("span",{style:{color:"#89DDFF"}},"()")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#545454","font-style":"italic"}},"# 注册 handler")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"application"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"add_handler"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"start_handler"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#545454","font-style":"italic"}},"# run!")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"application"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"run_polling"),s("span",{style:{color:"#89DDFF"}},"()")])])]),s("pre",{class:"shiki github-light vp-code-light"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"from"),s("span",{style:{color:"#24292E"}}," telegram "),s("span",{style:{color:"#D73A49"}},"import"),s("span",{style:{color:"#24292E"}}," Update")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"from"),s("span",{style:{color:"#24292E"}}," telegram.ext "),s("span",{style:{color:"#D73A49"}},"import"),s("span",{style:{color:"#24292E"}}," ApplicationBuilder, ContextTypes, CommandHandler")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"async"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"def"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"start"),s("span",{style:{color:"#24292E"}},"(update: Update, context: ContextTypes."),s("span",{style:{color:"#005CC5"}},"DEFAULT_TYPE"),s("span",{style:{color:"#24292E"}},"):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#032F62"}},"'''响应start命令'''")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    text "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#032F62"}},"'你好~我是一个bot'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"await"),s("span",{style:{color:"#24292E"}}," context.bot.send_message("),s("span",{style:{color:"#E36209"}},"chat_id"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"update.effective_chat.id,"),s("span",{style:{color:"#E36209"}},"text"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"text)")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"start_handler "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," CommandHandler("),s("span",{style:{color:"#032F62"}},"'start'"),s("span",{style:{color:"#24292E"}},", start)")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# 构建 bot")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#005CC5"}},"TOEKN"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#032F62"}},"'你 bot 的 api token'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"application "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," ApplicationBuilder().token("),s("span",{style:{color:"#005CC5"}},"TOKEN"),s("span",{style:{color:"#24292E"}},").build()")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# 注册 handler")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"application.add_handler(start_handler)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# run!")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"application.run_polling()")])])]),s("button",{class:"collapse"})],-1),ls=s("p",null,"到这里，其实你已经了解到了最基本的 telegram bot 编写规则，即：",-1),os=s("ol",null,[s("li",null,[l("编写回调函数。上面的例子中即为 "),s("code",null,"start"),l(" 这个函数。")]),s("li",null,[l("决定调用回调函数的规则。上述例子中，即为收到 "),s("code",null,"/start"),l(" 命令时，调用 "),s("code",null,"start"),l(" 函数")]),s("li",null,[l("实例化 "),s("code",null,"handler"),l(" , 注册给 "),s("code",null,"application"),l("。上述例子中，即为 "),s("code",null,"application.add_handler(start_handler)")])],-1),ns=s("div",{class:"tip custom-block"},[s("p",{class:"custom-block-title"},[s("span",{lang:"en"},"TIP"),s("span",{lang:"zh-CN"},"提示")]),s("p",null,"如果你的环境无法直接访问 Telegram 服务器，可以设置代理"),s("p",null,"全局代理, 代理整个程序."),s("div",{class:"language-python"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"python"),s("pre",{class:"shiki material-theme-darker vp-code-dark"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"os"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"environ"),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"http_proxy"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"代理地址"),s("span",{style:{color:"#89DDFF"}},"'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"os"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"environ"),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"https_proxy"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},"]"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"代理地址"),s("span",{style:{color:"#89DDFF"}},"'")])])]),s("pre",{class:"shiki github-light vp-code-light"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"os.environ["),s("span",{style:{color:"#032F62"}},"'http_proxy'"),s("span",{style:{color:"#24292E"}},"] "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#032F62"}},"'代理地址'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"os.environ["),s("span",{style:{color:"#032F62"}},"'https_proxy'"),s("span",{style:{color:"#24292E"}},"] "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#032F62"}},"'代理地址'")])])]),s("button",{class:"collapse"})]),s("p",null,"若想仅为 telegram bot api 设置代理,则需要改动一下构建 bot 部分的代码:"),s("p",null,"http(s)代理:"),s("div",{class:"language-python"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"python"),s("pre",{class:"shiki material-theme-darker vp-code-dark"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"proxy_url "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"http://USERNAME:PASSWORD@PROXY_HOST:PROXY_PORT"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#EEFFFF"}},"  "),s("span",{style:{color:"#545454","font-style":"italic"}},"# can also be a https proxy")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"application "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#82AAFF"}},"ApplicationBuilder"),s("span",{style:{color:"#89DDFF"}},"()."),s("span",{style:{color:"#82AAFF"}},"token"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"TOKEN"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},")."),s("span",{style:{color:"#82AAFF"}},"proxy_url"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"proxy_url"),s("span",{style:{color:"#89DDFF"}},")."),s("span",{style:{color:"#82AAFF"}},"get_updates_proxy_url"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"proxy_url"),s("span",{style:{color:"#89DDFF"}},")."),s("span",{style:{color:"#82AAFF"}},"build"),s("span",{style:{color:"#89DDFF"}},"()")])])]),s("pre",{class:"shiki github-light vp-code-light"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"proxy_url "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#032F62"}},"'http://USERNAME:PASSWORD@PROXY_HOST:PROXY_PORT'"),s("span",{style:{color:"#24292E"}},"  "),s("span",{style:{color:"#6A737D"}},"# can also be a https proxy")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"application "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," ApplicationBuilder().token("),s("span",{style:{color:"#032F62"}},'"TOKEN"'),s("span",{style:{color:"#24292E"}},").proxy_url(proxy_url).get_updates_proxy_url(proxy_url).build()")])])]),s("button",{class:"collapse"})]),s("p",null,[l("socks5代理,需要安装 "),s("code",null,"python-telegram-bot[socks]"),l(",然后:")]),s("div",{class:"language-python"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"python"),s("pre",{class:"shiki material-theme-darker vp-code-dark"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"proxy_url "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"socks5://user:pass@host:port"),s("span",{style:{color:"#89DDFF"}},'"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"application "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#82AAFF"}},"ApplicationBuilder"),s("span",{style:{color:"#89DDFF"}},"()."),s("span",{style:{color:"#82AAFF"}},"token"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"TOKEN"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},")."),s("span",{style:{color:"#82AAFF"}},"proxy_url"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"proxy_url"),s("span",{style:{color:"#89DDFF"}},")."),s("span",{style:{color:"#82AAFF"}},"get_updates_proxy_url"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"proxy_url"),s("span",{style:{color:"#89DDFF"}},")."),s("span",{style:{color:"#82AAFF"}},"build"),s("span",{style:{color:"#89DDFF"}},"()")])])]),s("pre",{class:"shiki github-light vp-code-light"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"proxy_url "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#032F62"}},'"socks5://user:pass@host:port"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"application "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," ApplicationBuilder().token("),s("span",{style:{color:"#032F62"}},'"TOKEN"'),s("span",{style:{color:"#24292E"}},").proxy_url(proxy_url).get_updates_proxy_url(proxy_url).build()")])])]),s("button",{class:"collapse"})])],-1),es=s("p",null,"接下来，写一些更有趣的功能，使用更复杂一些的规则来调用这些功能。",-1),as={id:"授予群成员头衔",tabindex:"-1"},ts=s("p",null,[l("让群成员可以通过 bot 自助获得一个头衔吧，比如，群友可以在群里使用 "),s("code",null,"/p@botname 好人"),l(" 来给自己加上 “好人” 的头衔。")],-1),cs=s("p",null,"当然，前提是 bot 自己要是管理员，并且具有相应的权限。",-1),ps=s("p",null,"要实现这个功能，可以这样写:",-1),Fs=s("div",{class:"language-python"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"python"),s("pre",{class:"shiki material-theme-darker vp-code-dark"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"async"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C792EA"}},"def"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#82AAFF"}},"set_right"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"update"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," Update"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"context"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," ContextTypes"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"DEFAULT_TYPE"),s("span",{style:{color:"#89DDFF"}},"):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"'''"),s("span",{style:{color:"#545454","font-style":"italic"}},"设置成员权限和头衔"),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"'''")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    chat_id "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," update"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"effective_chat"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"id")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    user_id "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," update"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"effective_user"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"id")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    bot_username_len "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#82AAFF"}},"len"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"update"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"_bot"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"name"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    custom_title "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," update"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"effective_message"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"text"),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#F78C6C"}},"3"),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#F07178"}},"bot_username_len"),s("span",{style:{color:"#89DDFF"}},":]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"if"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#89DDFF"}},"not"),s("span",{style:{color:"#EEFFFF"}}," custom_title"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"        custom_title "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," update"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"effective_user"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"username")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"try"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"        "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"await"),s("span",{style:{color:"#EEFFFF"}}," context"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"bot"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"promote_chat_member"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"chat_id"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"chat_id"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"user_id"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"user_id"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"can_manage_chat"),s("span",{style:{color:"#89DDFF"}},"=True)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"        "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"await"),s("span",{style:{color:"#EEFFFF"}}," context"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"bot"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"set_chat_administrator_custom_title"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"chat_id"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"chat_id"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"user_id"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"user_id"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"custom_title"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"custom_title"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"        text "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C792EA"}},"f"),s("span",{style:{color:"#C3E88D"}},"'好,你现在是"),s("span",{style:{color:"#F78C6C"}},"{"),s("span",{style:{color:"#EEFFFF"}},"custom_title"),s("span",{style:{color:"#F78C6C"}},"}"),s("span",{style:{color:"#C3E88D"}},"啦'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"        "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"await"),s("span",{style:{color:"#EEFFFF"}}," context"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"bot"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"send_message"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"chat_id"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"chat_id"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"reply_to_message_id"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"update"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"effective_message"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"id"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"text"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"text"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"except"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"        "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"await"),s("span",{style:{color:"#EEFFFF"}}," context"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"bot"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"send_message"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"chat_id"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"chat_id"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"text"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"不行!!"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},")")])])]),s("pre",{class:"shiki github-light vp-code-light"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"async"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"def"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"set_right"),s("span",{style:{color:"#24292E"}},"(update: Update, context: ContextTypes."),s("span",{style:{color:"#005CC5"}},"DEFAULT_TYPE"),s("span",{style:{color:"#24292E"}},"):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#032F62"}},"'''设置成员权限和头衔'''")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    chat_id "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," update.effective_chat.id")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    user_id "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," update.effective_user.id")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    bot_username_len "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"len"),s("span",{style:{color:"#24292E"}},"(update._bot.name)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    custom_title "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," update.effective_message.text["),s("span",{style:{color:"#005CC5"}},"3"),s("span",{style:{color:"#D73A49"}},"+"),s("span",{style:{color:"#24292E"}},"bot_username_len:]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"if"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"not"),s("span",{style:{color:"#24292E"}}," custom_title:")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        custom_title "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," update.effective_user.username")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"try"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#D73A49"}},"await"),s("span",{style:{color:"#24292E"}}," context.bot.promote_chat_member("),s("span",{style:{color:"#E36209"}},"chat_id"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"chat_id, "),s("span",{style:{color:"#E36209"}},"user_id"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"user_id, "),s("span",{style:{color:"#E36209"}},"can_manage_chat"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#005CC5"}},"True"),s("span",{style:{color:"#24292E"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#D73A49"}},"await"),s("span",{style:{color:"#24292E"}}," context.bot.set_chat_administrator_custom_title("),s("span",{style:{color:"#E36209"}},"chat_id"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"chat_id, "),s("span",{style:{color:"#E36209"}},"user_id"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"user_id, "),s("span",{style:{color:"#E36209"}},"custom_title"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"custom_title)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        text "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"f"),s("span",{style:{color:"#032F62"}},"'好,你现在是"),s("span",{style:{color:"#005CC5"}},"{"),s("span",{style:{color:"#24292E"}},"custom_title"),s("span",{style:{color:"#005CC5"}},"}"),s("span",{style:{color:"#032F62"}},"啦'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#D73A49"}},"await"),s("span",{style:{color:"#24292E"}}," context.bot.send_message("),s("span",{style:{color:"#E36209"}},"chat_id"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"chat_id, "),s("span",{style:{color:"#E36209"}},"reply_to_message_id"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"update.effective_message.id, "),s("span",{style:{color:"#E36209"}},"text"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"text)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"except"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#D73A49"}},"await"),s("span",{style:{color:"#24292E"}}," context.bot.send_message("),s("span",{style:{color:"#E36209"}},"chat_id"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"chat_id, "),s("span",{style:{color:"#E36209"}},"text"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#032F62"}},"'不行!!'"),s("span",{style:{color:"#24292E"}},")")])])]),s("button",{class:"collapse"})],-1),rs=s("p",null,"然后，添加这个功能的handler:",-1),ys=s("div",{class:"language-python"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"python"),s("pre",{class:"shiki material-theme-darker vp-code-dark"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"set_right_handler "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#82AAFF"}},"CommandHandler"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"p"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," set_right"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"application"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"add_handler"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"set_right_handler"),s("span",{style:{color:"#89DDFF"}},")")])])]),s("pre",{class:"shiki github-light vp-code-light"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"set_right_handler "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," CommandHandler("),s("span",{style:{color:"#032F62"}},"'p'"),s("span",{style:{color:"#24292E"}},", set_right)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"application.add_handler(set_right_handler)")])])]),s("button",{class:"collapse"})],-1),is=s("p",null,[l("注意handler的添加应该在 "),s("code",null,"application.run_polling()"),l(" 之前，也就是说 "),s("code",null,"application.run_polling()"),l(" 才是真正开始运行 bot")],-1),Ds=s("p",null,[l("简单解释一下 "),s("code",null,"set_right"),l(" 这个函数:")],-1),Es=s("p",null,[l("首先，设置了调用这个函数时的 "),s("code",null,"chat_id"),l(" 和 "),s("code",null,"user_id"),l(" 为当前聊天和当前用户")],-1),ds=s("p",null,[l("然后用 "),s("code",null,"len(update._bot.name)"),l(" 获取 bot 自己用户名的长度，用于下面的切片选取用户想要的头衔")],-1),hs=s("p",null,[l("而 "),s("code",null,"custom_title = update.effective_message.text[3+bot_username_len:]"),l(" 即获取用户想要的头衔，存储在 "),s("code",null,"custom_title"),l(" 中，下面的 if not 的作用是，如果用户没有发送他想要的头衔，那么默认头衔为他的用户名")],-1),us=s("p",null,"由于只有管理员才有头衔，所以我们使用 promote_chat_member() 方法设置成员权限，将其的 can_manage_chat 权限设置为 True 。注意，即使这样设置了，用户实则是有名无权的状态，只有一个管理员的名头，实际上没有任何权限。",-1),_s=s("blockquote",null,[s("p",null,"要想赋予权限，你可以向 promote_chat_member() 方法中继续添加参数，如 can_pin_messages=True 可置顶消息")],-1),As=s("p",null,[l("然后就可以使用 "),s("code",null,"set_chat_administrator_custom_title()"),l(" 方法设置成员头衔了，如果成功了，会继续执行接下来的语句，将结果反馈给用户。")],-1),ms={id:"响应未知命令",tabindex:"-1"},gs=s("p",null,"如果 bot 只能回应设置好的命令就太无趣了，所以再编写一个当收到未知命令时的执行功能 比如，想要让 bot 回应未知命令说 “我不会这个哦~”，可以这样写",-1),fs=s("div",{class:"language-python"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"python"),s("pre",{class:"shiki material-theme-darker vp-code-dark"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"async"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C792EA"}},"def"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#82AAFF"}},"unknown"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"update"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," Update"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"context"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," ContextTypes"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"DEFAULT_TYPE"),s("span",{style:{color:"#89DDFF"}},"):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"await"),s("span",{style:{color:"#EEFFFF"}}," context"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"bot"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"send_message"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"chat_id"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"update"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"effective_chat"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"id"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"text"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"我不会这个哦~"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},")")])])]),s("pre",{class:"shiki github-light vp-code-light"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"async"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"def"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"unknown"),s("span",{style:{color:"#24292E"}},"(update: Update, context: ContextTypes."),s("span",{style:{color:"#005CC5"}},"DEFAULT_TYPE"),s("span",{style:{color:"#24292E"}},"):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"await"),s("span",{style:{color:"#24292E"}}," context.bot.send_message("),s("span",{style:{color:"#E36209"}},"chat_id"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"update.effective_chat.id, "),s("span",{style:{color:"#E36209"}},"text"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#032F62"}},'"我不会这个哦~"'),s("span",{style:{color:"#24292E"}},")")])])]),s("button",{class:"collapse"})],-1),Cs=s("p",null,[l("然后，添加它的 "),s("code",null,"handler"),l("。这时候可能就出现问题： 前面的两个功能都是回应一个特定的命令，在这里，我们希望它回应除已经设定的命令外的其他所有命令，该怎么做？")],-1),bs=s("p",null,[l("这就需要用到 "),s("code",null,"filters"),l(" ，即过滤需要处理器处理的更新. 并且要"),s("strong",null,"设置功能的优先级"),l(" 你需要先导入它")],-1),ks=s("div",{class:"language-python"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"python"),s("pre",{class:"shiki material-theme-darker vp-code-dark"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"from"),s("span",{style:{color:"#EEFFFF"}}," telegram"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#EEFFFF"}},"ext "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"import"),s("span",{style:{color:"#EEFFFF"}}," filters")])])]),s("pre",{class:"shiki github-light vp-code-light"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"from"),s("span",{style:{color:"#24292E"}}," telegram.ext "),s("span",{style:{color:"#D73A49"}},"import"),s("span",{style:{color:"#24292E"}}," filters")])])]),s("button",{class:"collapse"})],-1),xs=s("p",null,"然后可以这样写:",-1),vs=s("div",{class:"language-python"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"python"),s("pre",{class:"shiki material-theme-darker vp-code-dark"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"unknown_handler "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#82AAFF"}},"MessageHandler"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"filters"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"COMMAND"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," unknown"),s("span",{style:{color:"#89DDFF"}},")")])])]),s("pre",{class:"shiki github-light vp-code-light"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"unknown_handler "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," MessageHandler(filters."),s("span",{style:{color:"#005CC5"}},"COMMAND"),s("span",{style:{color:"#24292E"}},", unknown)")])])]),s("button",{class:"collapse"})],-1),Ts=s("p",null,[s("code",null,"filters.COMMAND"),l(" 即为过滤出命令。而设置优先级其实很简单，在不对处理器分组的情况下, "),s("strong",null,[l("添加 "),s("code",null,"handler"),l(" 的顺序越靠后，对应功能的优先级越低")])],-1),ws=s("p",null,[l("也就是说，我们需要在其他命令类 "),s("code",null,"handler"),l(" 之后，添加 "),s("code",null,"unknown_handler")],-1),Ps=s("div",{class:"language-python"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"python"),s("pre",{class:"shiki material-theme-darker vp-code-dark"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"application"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"add_handler"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"start_handler"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"application"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"add_handler"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"set_right_handler"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"application"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"add_handler"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"unkonw_handler"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"application"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"run_polling"),s("span",{style:{color:"#89DDFF"}},"()")])])]),s("pre",{class:"shiki github-light vp-code-light"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"application.add_handler(start_handler)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"application.add_handler(set_right_handler)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"application.add_handler(unkonw_handler)")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"application.run_polling()")])])]),s("button",{class:"collapse"})],-1),Us={id:"简单的关键词回复",tabindex:"-1"},Os=s("p",null,"bot 最常见的功能之一就是根据关键词回复特定内容，比如，当对 bot 说早安之类的话时，让 bot 对此做出回应。下面来实现这这一功能",-1),Hs=s("p",null,[l("由于命令和普通消息是两种不同的消息类，处理它们的方法是不一样的，针对非命令消息，要使用 "),s("code",null,"MessageHandler"),l(":")],-1),Ns=s("div",{class:"language-python"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"python"),s("pre",{class:"shiki material-theme-darker vp-code-dark"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"from"),s("span",{style:{color:"#EEFFFF"}}," telegram"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#EEFFFF"}},"ext "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"import"),s("span",{style:{color:"#EEFFFF"}}," MessageHandler")])])]),s("pre",{class:"shiki github-light vp-code-light"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"from"),s("span",{style:{color:"#24292E"}}," telegram.ext "),s("span",{style:{color:"#D73A49"}},"import"),s("span",{style:{color:"#24292E"}}," MessageHandler")])])]),s("button",{class:"collapse"})],-1),Bs=s("p",null,"首先还是要编写这个功能执行的函数。",-1),Ms=s("div",{class:"language-python"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"python"),s("pre",{class:"shiki material-theme-darker vp-code-dark"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"import"),s("span",{style:{color:"#EEFFFF"}}," random")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"async"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C792EA"}},"def"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#82AAFF"}},"ohayo"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"update"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," Update"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"context"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," ContextTypes"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"DEFAULT_TYPE"),s("span",{style:{color:"#89DDFF"}},"):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    texts "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"早上好呀"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"我的小鱼你醒了，还记得清晨吗"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"哦哈哟~"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},"]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"await"),s("span",{style:{color:"#EEFFFF"}}," context"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"bot"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"send_message"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"chat_id"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"update"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"effective_chat"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"id"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"text"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"random"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"choice"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"text"),s("span",{style:{color:"#89DDFF"}},"))")])])]),s("pre",{class:"shiki github-light vp-code-light"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"import"),s("span",{style:{color:"#24292E"}}," random")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"async"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"def"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"ohayo"),s("span",{style:{color:"#24292E"}},"(update: Update, context: ContextTypes."),s("span",{style:{color:"#005CC5"}},"DEFAULT_TYPE"),s("span",{style:{color:"#24292E"}},"):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    texts "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," ["),s("span",{style:{color:"#032F62"}},"'早上好呀'"),s("span",{style:{color:"#24292E"}},","),s("span",{style:{color:"#032F62"}},"'我的小鱼你醒了，还记得清晨吗'"),s("span",{style:{color:"#24292E"}},","),s("span",{style:{color:"#032F62"}},"'哦哈哟~'"),s("span",{style:{color:"#24292E"}},"]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"await"),s("span",{style:{color:"#24292E"}}," context.bot.send_message("),s("span",{style:{color:"#E36209"}},"chat_id"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"update.effective_chat.id, "),s("span",{style:{color:"#E36209"}},"text"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"random.choice(text))")])])]),s("button",{class:"collapse"})],-1),Rs=s("p",null,[l("由于只回复一个固定的消息过于单调，所以我们使用 "),s("code",null,"random"),l(" 库来从一个列表中随机选择一个回复")],-1),$s=s("p",null,[l("实际上，这个函数仍然只是简单的发送消息，而何时调用这个函数，并不是这个函数本身要做的事，而是由接下来我们要编写的 "),s("code",null,"MessageHandler"),l(" 中的 "),s("code",null,"filters"),l(" 决定的:")],-1),Ys=s("div",{class:"language-python"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"python"),s("pre",{class:"shiki material-theme-darker vp-code-dark"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"filter_ohayo "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," filters"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"Regex"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"早安|早上好|哦哈哟|ohayo"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"ohayo_handler "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#82AAFF"}},"MessageHandler"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"filter_ohayo"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," ohayo"),s("span",{style:{color:"#89DDFF"}},")")])])]),s("pre",{class:"shiki github-light vp-code-light"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"filter_ohayo "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," filters.Regex("),s("span",{style:{color:"#032F62"}},"'早安|早上好|哦哈哟|ohayo'"),s("span",{style:{color:"#24292E"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"ohayo_handler "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," MessageHandler(filter_ohayo, ohayo)")])])]),s("button",{class:"collapse"})],-1),Ks=s("p",null,[s("code",null,"filters.Regex()"),l(" 即为使用正则表达式过滤，我们使用 "),s("code",null,"'早安|早上好|哦哈哟|ohayo'"),l(" 这个表达式，很容易理解何时会调用 "),s("code",null,"ohayo"),l(" 这个函数")],-1),Ls=s("p",null,[l("记得添加它的 "),s("code",null,"handler")],-1),Ss=s("div",{class:"language-python"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"python"),s("pre",{class:"shiki material-theme-darker vp-code-dark"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"application"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"add_handler"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"ohayo_handler"),s("span",{style:{color:"#89DDFF"}},")")])])]),s("pre",{class:"shiki github-light vp-code-light"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"application.add_handler(ohayo_handler)")])])]),s("button",{class:"collapse"})],-1),Is=s("hr",null,null,-1),js=s("p",null,"上面完整代码:",-1),Gs=s("div",{class:"language-python"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"python"),s("pre",{class:"shiki material-theme-darker vp-code-dark"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"import"),s("span",{style:{color:"#EEFFFF"}}," random")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"from"),s("span",{style:{color:"#EEFFFF"}}," telegram "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"import"),s("span",{style:{color:"#EEFFFF"}}," Update")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#89DDFF","font-style":"italic"}},"from"),s("span",{style:{color:"#EEFFFF"}}," telegram"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#EEFFFF"}},"ext "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"import"),s("span",{style:{color:"#EEFFFF"}}," ApplicationBuilder"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#EEFFFF"}}," ContextTypes"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#EEFFFF"}}," CommandHandler"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#EEFFFF"}}," filters"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#EEFFFF"}}," MessageHandler")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"async"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C792EA"}},"def"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#82AAFF"}},"start"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"update"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," Update"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"context"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," ContextTypes"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"DEFAULT_TYPE"),s("span",{style:{color:"#89DDFF"}},"):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"'''"),s("span",{style:{color:"#545454","font-style":"italic"}},"响应start命令"),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"'''")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    text "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"你好~我是一个bot"),s("span",{style:{color:"#89DDFF"}},"'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"await"),s("span",{style:{color:"#EEFFFF"}}," context"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"bot"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"send_message"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"chat_id"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"update"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"effective_chat"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"id"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"text"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"text"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"async"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C792EA"}},"def"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#82AAFF"}},"set_right"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"update"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," Update"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"context"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," ContextTypes"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"DEFAULT_TYPE"),s("span",{style:{color:"#89DDFF"}},"):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"'''"),s("span",{style:{color:"#545454","font-style":"italic"}},"设置成员权限和头衔"),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"'''")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    chat_id "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," update"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"effective_chat"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"id")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    user_id "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," update"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"effective_user"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"id")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    bot_username_len "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#82AAFF"}},"len"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"update"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"_bot"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"name"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    custom_title "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," update"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"effective_message"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"text"),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#F78C6C"}},"3"),s("span",{style:{color:"#89DDFF"}},"+"),s("span",{style:{color:"#F07178"}},"bot_username_len"),s("span",{style:{color:"#89DDFF"}},":]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"if"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#89DDFF"}},"not"),s("span",{style:{color:"#EEFFFF"}}," custom_title"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"        custom_title "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," update"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"effective_user"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"username")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"try"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"        "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"await"),s("span",{style:{color:"#EEFFFF"}}," context"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"bot"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"promote_chat_member"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"chat_id"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"chat_id"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"user_id"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"user_id"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"can_manage_chat"),s("span",{style:{color:"#89DDFF"}},"=True)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"        "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"await"),s("span",{style:{color:"#EEFFFF"}}," context"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"bot"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"set_chat_administrator_custom_title"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"chat_id"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"chat_id"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"user_id"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"user_id"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"custom_title"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"custom_title"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"        text "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C792EA"}},"f"),s("span",{style:{color:"#C3E88D"}},"'好,你现在是"),s("span",{style:{color:"#F78C6C"}},"{"),s("span",{style:{color:"#EEFFFF"}},"custom_title"),s("span",{style:{color:"#F78C6C"}},"}"),s("span",{style:{color:"#C3E88D"}},"啦'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"        "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"await"),s("span",{style:{color:"#EEFFFF"}}," context"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"bot"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"send_message"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"chat_id"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"chat_id"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"reply_to_message_id"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"update"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"effective_message"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"id"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"text"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"text"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"except"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"        "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"await"),s("span",{style:{color:"#EEFFFF"}}," context"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"bot"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"send_message"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"chat_id"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"chat_id"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"text"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"不行!!"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"async"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C792EA"}},"def"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#82AAFF"}},"unknown"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"update"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," Update"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"context"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," ContextTypes"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"DEFAULT_TYPE"),s("span",{style:{color:"#89DDFF"}},"):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"await"),s("span",{style:{color:"#EEFFFF"}}," context"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"bot"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"send_message"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"chat_id"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"update"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"effective_chat"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"id"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"text"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"我不会这个哦~"),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C792EA"}},"async"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C792EA"}},"def"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#82AAFF"}},"ohayo"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"update"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," Update"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"context"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," ContextTypes"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"DEFAULT_TYPE"),s("span",{style:{color:"#89DDFF"}},"):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    texts "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#89DDFF"}},"["),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"早上好呀"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"我的小鱼你醒了，还记得清晨吗"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"哦哈哟~"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},"]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"await"),s("span",{style:{color:"#EEFFFF"}}," context"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"bot"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"send_message"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"chat_id"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"update"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"effective_chat"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"id"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," "),s("span",{style:{color:"#EEFFFF","font-style":"italic"}},"text"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#82AAFF"}},"random"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"choice"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"text"),s("span",{style:{color:"#89DDFF"}},"))")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"start_handler "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#82AAFF"}},"CommandHandler"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"start"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," start"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"set_right_handler "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#82AAFF"}},"CommandHandler"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"p"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," set_right"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"unknown_handler "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#82AAFF"}},"MessageHandler"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"filters"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#F07178"}},"COMMAND"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," unknown"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"filter_ohayo "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," filters"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"Regex"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"早安|早上好|哦哈哟|ohayo"),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"ohayo_handler "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#82AAFF"}},"MessageHandler"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"filter_ohayo"),s("span",{style:{color:"#89DDFF"}},","),s("span",{style:{color:"#82AAFF"}}," ohayo"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#545454","font-style":"italic"}},"# 构建 bot")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"TOEKN"),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#89DDFF"}},"'"),s("span",{style:{color:"#C3E88D"}},"你 bot 的 api token"),s("span",{style:{color:"#89DDFF"}},"'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"application "),s("span",{style:{color:"#89DDFF"}},"="),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#82AAFF"}},"ApplicationBuilder"),s("span",{style:{color:"#89DDFF"}},"()."),s("span",{style:{color:"#82AAFF"}},"token"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"TOKEN"),s("span",{style:{color:"#89DDFF"}},")."),s("span",{style:{color:"#82AAFF"}},"build"),s("span",{style:{color:"#89DDFF"}},"()")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#545454","font-style":"italic"}},"# 注册 handler")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"application"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"add_handler"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"start_handler"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"application"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"add_handler"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"set_right_handler"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"application"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"add_handler"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"unkonw_handler"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"application"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"add_handler"),s("span",{style:{color:"#89DDFF"}},"("),s("span",{style:{color:"#82AAFF"}},"ohayo_handler"),s("span",{style:{color:"#89DDFF"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#545454","font-style":"italic"}},"# run!")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"application"),s("span",{style:{color:"#89DDFF"}},"."),s("span",{style:{color:"#82AAFF"}},"run_polling"),s("span",{style:{color:"#89DDFF"}},"()")])])]),s("pre",{class:"shiki github-light vp-code-light"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"import"),s("span",{style:{color:"#24292E"}}," random")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"from"),s("span",{style:{color:"#24292E"}}," telegram "),s("span",{style:{color:"#D73A49"}},"import"),s("span",{style:{color:"#24292E"}}," Update")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"from"),s("span",{style:{color:"#24292E"}}," telegram.ext "),s("span",{style:{color:"#D73A49"}},"import"),s("span",{style:{color:"#24292E"}}," ApplicationBuilder, ContextTypes, CommandHandler, filters, MessageHandler")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"async"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"def"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"start"),s("span",{style:{color:"#24292E"}},"(update: Update, context: ContextTypes."),s("span",{style:{color:"#005CC5"}},"DEFAULT_TYPE"),s("span",{style:{color:"#24292E"}},"):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#032F62"}},"'''响应start命令'''")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    text "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#032F62"}},"'你好~我是一个bot'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"await"),s("span",{style:{color:"#24292E"}}," context.bot.send_message("),s("span",{style:{color:"#E36209"}},"chat_id"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"update.effective_chat.id,"),s("span",{style:{color:"#E36209"}},"text"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"text)")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"async"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"def"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"set_right"),s("span",{style:{color:"#24292E"}},"(update: Update, context: ContextTypes."),s("span",{style:{color:"#005CC5"}},"DEFAULT_TYPE"),s("span",{style:{color:"#24292E"}},"):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#032F62"}},"'''设置成员权限和头衔'''")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    chat_id "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," update.effective_chat.id")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    user_id "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," update.effective_user.id")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    bot_username_len "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#005CC5"}},"len"),s("span",{style:{color:"#24292E"}},"(update._bot.name)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    custom_title "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," update.effective_message.text["),s("span",{style:{color:"#005CC5"}},"3"),s("span",{style:{color:"#D73A49"}},"+"),s("span",{style:{color:"#24292E"}},"bot_username_len:]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"if"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"not"),s("span",{style:{color:"#24292E"}}," custom_title:")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        custom_title "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," update.effective_user.username")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"try"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#D73A49"}},"await"),s("span",{style:{color:"#24292E"}}," context.bot.promote_chat_member("),s("span",{style:{color:"#E36209"}},"chat_id"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"chat_id, "),s("span",{style:{color:"#E36209"}},"user_id"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"user_id, "),s("span",{style:{color:"#E36209"}},"can_manage_chat"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#005CC5"}},"True"),s("span",{style:{color:"#24292E"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#D73A49"}},"await"),s("span",{style:{color:"#24292E"}}," context.bot.set_chat_administrator_custom_title("),s("span",{style:{color:"#E36209"}},"chat_id"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"chat_id, "),s("span",{style:{color:"#E36209"}},"user_id"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"user_id, "),s("span",{style:{color:"#E36209"}},"custom_title"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"custom_title)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        text "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"f"),s("span",{style:{color:"#032F62"}},"'好,你现在是"),s("span",{style:{color:"#005CC5"}},"{"),s("span",{style:{color:"#24292E"}},"custom_title"),s("span",{style:{color:"#005CC5"}},"}"),s("span",{style:{color:"#032F62"}},"啦'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#D73A49"}},"await"),s("span",{style:{color:"#24292E"}}," context.bot.send_message("),s("span",{style:{color:"#E36209"}},"chat_id"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"chat_id, "),s("span",{style:{color:"#E36209"}},"reply_to_message_id"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"update.effective_message.id, "),s("span",{style:{color:"#E36209"}},"text"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"text)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"except"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#D73A49"}},"await"),s("span",{style:{color:"#24292E"}}," context.bot.send_message("),s("span",{style:{color:"#E36209"}},"chat_id"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"chat_id, "),s("span",{style:{color:"#E36209"}},"text"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#032F62"}},"'不行!!'"),s("span",{style:{color:"#24292E"}},")")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"async"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"def"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"unknown"),s("span",{style:{color:"#24292E"}},"(update: Update, context: ContextTypes."),s("span",{style:{color:"#005CC5"}},"DEFAULT_TYPE"),s("span",{style:{color:"#24292E"}},"):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"await"),s("span",{style:{color:"#24292E"}}," context.bot.send_message("),s("span",{style:{color:"#E36209"}},"chat_id"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"update.effective_chat.id, "),s("span",{style:{color:"#E36209"}},"text"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#032F62"}},'"我不会这个哦~"'),s("span",{style:{color:"#24292E"}},")")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"async"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#D73A49"}},"def"),s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#6F42C1"}},"ohayo"),s("span",{style:{color:"#24292E"}},"(update: Update, context: ContextTypes."),s("span",{style:{color:"#005CC5"}},"DEFAULT_TYPE"),s("span",{style:{color:"#24292E"}},"):")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    texts "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," ["),s("span",{style:{color:"#032F62"}},"'早上好呀'"),s("span",{style:{color:"#24292E"}},","),s("span",{style:{color:"#032F62"}},"'我的小鱼你醒了，还记得清晨吗'"),s("span",{style:{color:"#24292E"}},","),s("span",{style:{color:"#032F62"}},"'哦哈哟~'"),s("span",{style:{color:"#24292E"}},"]")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#D73A49"}},"await"),s("span",{style:{color:"#24292E"}}," context.bot.send_message("),s("span",{style:{color:"#E36209"}},"chat_id"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"update.effective_chat.id, "),s("span",{style:{color:"#E36209"}},"text"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}},"random.choice(text))")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"start_handler "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," CommandHandler("),s("span",{style:{color:"#032F62"}},"'start'"),s("span",{style:{color:"#24292E"}},", start)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"set_right_handler "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," CommandHandler("),s("span",{style:{color:"#032F62"}},"'p'"),s("span",{style:{color:"#24292E"}},", set_right)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"unknown_handler "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," MessageHandler(filters."),s("span",{style:{color:"#005CC5"}},"COMMAND"),s("span",{style:{color:"#24292E"}},", unknown)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"filter_ohayo "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," filters.Regex("),s("span",{style:{color:"#032F62"}},"'早安|早上好|哦哈哟|ohayo'"),s("span",{style:{color:"#24292E"}},")")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"ohayo_handler "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," MessageHandler(filter_ohayo, ohayo)")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# 构建 bot")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#005CC5"}},"TOEKN"),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#032F62"}},"'你 bot 的 api token'")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"application "),s("span",{style:{color:"#D73A49"}},"="),s("span",{style:{color:"#24292E"}}," ApplicationBuilder().token("),s("span",{style:{color:"#005CC5"}},"TOKEN"),s("span",{style:{color:"#24292E"}},").build()")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# 注册 handler")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"application.add_handler(start_handler)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"application.add_handler(set_right_handler)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"application.add_handler(unkonw_handler)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"application.add_handler(ohayo_handler)")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#6A737D"}},"# run!")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"application.run_polling()")])])]),s("button",{class:"collapse"})],-1),Zs={id:"部署",tabindex:"-1"},qs=s("p",null,"python 程序的环境管理很烦人,用docker来跑再合适不过.",-1),Vs={id:"docker-本地构建",tabindex:"-1"},Ws=s("p",null,[l("如果要在本地构建 docker 镜像,参考下面的 "),s("code",null,"Dockerfile"),l(" 文件")],-1),Xs=s("div",{class:"language-Dockerfile"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"Dockerfile"),s("pre",{class:"shiki material-theme-darker vp-code-dark"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#F78C6C"}},"FROM"),s("span",{style:{color:"#EEFFFF"}}," python:3.9")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F78C6C"}},"COPY"),s("span",{style:{color:"#EEFFFF"}}," . /app")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F78C6C"}},"WORKDIR"),s("span",{style:{color:"#EEFFFF"}}," /app")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F78C6C"}},"RUN"),s("span",{style:{color:"#EEFFFF"}}," pip install -r requirements.txt")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F78C6C"}},"ENTRYPOINT"),s("span",{style:{color:"#EEFFFF"}}," [ "),s("span",{style:{color:"#C3E88D"}},'"python"'),s("span",{style:{color:"#EEFFFF"}},","),s("span",{style:{color:"#C3E88D"}},'"/app/bot.py"'),s("span",{style:{color:"#EEFFFF"}}," ]")])])]),s("pre",{class:"shiki github-light vp-code-light"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"FROM"),s("span",{style:{color:"#24292E"}}," python:3.9")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"COPY"),s("span",{style:{color:"#24292E"}}," . /app")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"WORKDIR"),s("span",{style:{color:"#24292E"}}," /app")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"RUN"),s("span",{style:{color:"#24292E"}}," pip install -r requirements.txt")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#D73A49"}},"ENTRYPOINT"),s("span",{style:{color:"#24292E"}}," [ "),s("span",{style:{color:"#032F62"}},'"python"'),s("span",{style:{color:"#24292E"}},","),s("span",{style:{color:"#032F62"}},'"/app/bot.py"'),s("span",{style:{color:"#24292E"}}," ]")])])]),s("button",{class:"collapse"})],-1),zs=s("p",null,"将 Dockerfile 文件放到合适的目录(项目根目录即可),然后执行",-1),Qs=s("p",null,[s("code",null,"docker build -t bot .")],-1),Js=s("p",null,"注意后面有一个 .",-1),sl=s("p",null,[l("然后使用 "),s("code",null,"docker run -d bot"),l(" 启动容器,运行 bot")],-1),ll={id:"使用-github-action-自动构建",tabindex:"-1"},ol=s("p",null,[l("github action 可以构建 docker 镜像并发布到 ghcr,方便在其他地方部署 docker 容器.你依然需要在项目中写好 "),s("code",null,"Dockerfile")],-1),nl=s("p",null,[l("在项目中新建 "),s("code",null,".github/workflows/build-docker.yml"),l(",参考以下配置")],-1),el=s("div",{class:"language-yml"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"yml"),s("pre",{class:"shiki material-theme-darker vp-code-dark"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"name"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"Build and publish docker container")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#FF9CAC"}},"on"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#F07178"}},"push"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"     "),s("span",{style:{color:"#F07178"}},"branches"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"     "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"main")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"  "),s("span",{style:{color:"#F07178"}},"workflow_dispatch"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    ")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"jobs"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"  "),s("span",{style:{color:"#F07178"}},"publish"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    "),s("span",{style:{color:"#F07178"}},"name"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"Publish container image")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    "),s("span",{style:{color:"#F07178"}},"runs-on"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"ubuntu-20.04")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    "),s("span",{style:{color:"#F07178"}},"env"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"      "),s("span",{style:{color:"#F07178"}},"TZ"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"Asia/Shanghai")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    "),s("span",{style:{color:"#F07178"}},"steps"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"      "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#F07178"}},"name"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"Checkout")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"        "),s("span",{style:{color:"#F07178"}},"uses"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"actions/checkout@v3")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"      "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#F07178"}},"name"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"OCI meta")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"        "),s("span",{style:{color:"#F07178"}},"id"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"meta")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"        "),s("span",{style:{color:"#F07178"}},"uses"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"docker/metadata-action@v4.1.1")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"        "),s("span",{style:{color:"#F07178"}},"with"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"          "),s("span",{style:{color:"#F07178"}},"images"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"ghcr.io/${{ github.repository }}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"          "),s("span",{style:{color:"#F07178"}},"tags"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#89DDFF","font-style":"italic"}},"|")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"            type=edge,branch=main")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"            type=ref,event=branch")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"            type=semver,pattern={{version}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"            type=semver,pattern={{major}}.{{minor}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"            type=semver,pattern={{major}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#C3E88D"}},"            type=sha")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"      "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#F07178"}},"name"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"Set up Docker Buildx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"        "),s("span",{style:{color:"#F07178"}},"uses"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"docker/setup-buildx-action@v2")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"        ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"      "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#F07178"}},"name"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"Set up QEMU")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"        "),s("span",{style:{color:"#F07178"}},"uses"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"docker/setup-qemu-action@v2")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"      "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#F07178"}},"name"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"Login to GHCR")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"        "),s("span",{style:{color:"#F07178"}},"uses"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"docker/login-action@v2")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"        "),s("span",{style:{color:"#F07178"}},"with"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"          "),s("span",{style:{color:"#F07178"}},"registry"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"ghcr.io")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"          "),s("span",{style:{color:"#F07178"}},"username"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"${{ github.repository_owner }}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"          "),s("span",{style:{color:"#F07178"}},"password"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"${{ secrets.GITHUB_TOKEN }}")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"      "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#F07178"}},"name"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"Build and push")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"        "),s("span",{style:{color:"#F07178"}},"uses"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"docker/build-push-action@v3")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"        "),s("span",{style:{color:"#F07178"}},"with"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"          "),s("span",{style:{color:"#F07178"}},"context"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#F78C6C"}},".")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"          "),s("span",{style:{color:"#F07178"}},"push"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#FF9CAC"}},"true")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"          "),s("span",{style:{color:"#F07178"}},"tags"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"${{ steps.meta.outputs.tags }}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"          "),s("span",{style:{color:"#F07178"}},"labels"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"${{ steps.meta.outputs.labels }}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"          "),s("span",{style:{color:"#F07178"}},"platforms"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"linux/amd64,linux/arm64")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"          "),s("span",{style:{color:"#F07178"}},"cache-from"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"type=gha")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"          "),s("span",{style:{color:"#F07178"}},"cache-to"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"type=gha,mode=max")])])]),s("pre",{class:"shiki github-light vp-code-light"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#22863A"}},"name"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"Build and publish docker container")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#005CC5"}},"on"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}}," "),s("span",{style:{color:"#22863A"}},"push"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"     "),s("span",{style:{color:"#22863A"}},"branches"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"     - "),s("span",{style:{color:"#032F62"}},"main")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"  "),s("span",{style:{color:"#22863A"}},"workflow_dispatch"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    ")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#22863A"}},"jobs"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"  "),s("span",{style:{color:"#22863A"}},"publish"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#22863A"}},"name"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"Publish container image")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#22863A"}},"runs-on"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"ubuntu-20.04")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#22863A"}},"env"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      "),s("span",{style:{color:"#22863A"}},"TZ"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"Asia/Shanghai")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#22863A"}},"steps"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      - "),s("span",{style:{color:"#22863A"}},"name"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"Checkout")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"uses"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"actions/checkout@v3")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      - "),s("span",{style:{color:"#22863A"}},"name"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"OCI meta")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"id"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"meta")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"uses"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"docker/metadata-action@v4.1.1")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"with"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"images"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"ghcr.io/${{ github.repository }}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"tags"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#D73A49"}},"|")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#032F62"}},"            type=edge,branch=main")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#032F62"}},"            type=ref,event=branch")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#032F62"}},"            type=semver,pattern={{version}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#032F62"}},"            type=semver,pattern={{major}}.{{minor}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#032F62"}},"            type=semver,pattern={{major}}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#032F62"}},"            type=sha")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      - "),s("span",{style:{color:"#22863A"}},"name"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"Set up Docker Buildx")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"uses"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"docker/setup-buildx-action@v2")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        ")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      - "),s("span",{style:{color:"#22863A"}},"name"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"Set up QEMU")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"uses"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"docker/setup-qemu-action@v2")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      - "),s("span",{style:{color:"#22863A"}},"name"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"Login to GHCR")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"uses"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"docker/login-action@v2")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"with"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"registry"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"ghcr.io")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"username"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"${{ github.repository_owner }}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"password"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"${{ secrets.GITHUB_TOKEN }}")]),l(`
`),s("span",{class:"line"}),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      - "),s("span",{style:{color:"#22863A"}},"name"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"Build and push")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"uses"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"docker/build-push-action@v3")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"        "),s("span",{style:{color:"#22863A"}},"with"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"context"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#005CC5"}},".")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"push"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#005CC5"}},"true")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"tags"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"${{ steps.meta.outputs.tags }}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"labels"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"${{ steps.meta.outputs.labels }}")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"platforms"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"linux/amd64,linux/arm64")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"cache-from"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"type=gha")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"          "),s("span",{style:{color:"#22863A"}},"cache-to"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"type=gha,mode=max")])])]),s("button",{class:"collapse"})],-1),al=s("p",null,[l("然后可以使用 "),s("code",null,"docker pull"),l(" 的方法运行,或者使用 docker compose:")],-1),tl=s("p",null,[l("新建 "),s("code",null,"docker-compose.yml"),l(",参考以下内容")],-1),cl=s("div",{class:"language-yml"},[s("button",{title:"Copy Code",class:"copy"}),s("span",{class:"lang"},"yml"),s("pre",{class:"shiki material-theme-darker vp-code-dark"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"version"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#89DDFF"}},'"'),s("span",{style:{color:"#C3E88D"}},"3"),s("span",{style:{color:"#89DDFF"}},'"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#F07178"}},"services"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"  "),s("span",{style:{color:"#F07178"}},"kmua"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    "),s("span",{style:{color:"#F07178"}},"image"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"ghcr.io/krau/kmua-bot:main")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    "),s("span",{style:{color:"#F07178"}},"container_name"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"kmua-main")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    "),s("span",{style:{color:"#F07178"}},"init"),s("span",{style:{color:"#89DDFF"}},":"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#FF9CAC"}},"true")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    "),s("span",{style:{color:"#F07178"}},"volumes"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"      "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"./data:/kmua/data")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"      "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"./logs:/kmua/logs")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"      "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"./config.yml:/kmua/config.yml")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"    "),s("span",{style:{color:"#F07178"}},"environment"),s("span",{style:{color:"#89DDFF"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#EEFFFF"}},"      "),s("span",{style:{color:"#89DDFF"}},"-"),s("span",{style:{color:"#EEFFFF"}}," "),s("span",{style:{color:"#C3E88D"}},"TZ=Asia/Shanghai")])])]),s("pre",{class:"shiki github-light vp-code-light"},[s("code",null,[s("span",{class:"line"},[s("span",{style:{color:"#22863A"}},"version"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},'"3"')]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#22863A"}},"services"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"  "),s("span",{style:{color:"#22863A"}},"kmua"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#22863A"}},"image"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"ghcr.io/krau/kmua-bot:main")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#22863A"}},"container_name"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#032F62"}},"kmua-main")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#22863A"}},"init"),s("span",{style:{color:"#24292E"}},": "),s("span",{style:{color:"#005CC5"}},"true")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#22863A"}},"volumes"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      - "),s("span",{style:{color:"#032F62"}},"./data:/kmua/data")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      - "),s("span",{style:{color:"#032F62"}},"./logs:/kmua/logs")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      - "),s("span",{style:{color:"#032F62"}},"./config.yml:/kmua/config.yml")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"    "),s("span",{style:{color:"#22863A"}},"environment"),s("span",{style:{color:"#24292E"}},":")]),l(`
`),s("span",{class:"line"},[s("span",{style:{color:"#24292E"}},"      - "),s("span",{style:{color:"#032F62"}},"TZ=Asia/Shanghai")])])]),s("button",{class:"collapse"})],-1),pl=s("p",null,"注意根据自己需要更改",-1),Fl=s("p",null,[l("然后就可以使用 "),s("code",null,"docker compose up -d"),l(" 启动容器")],-1);function rl(a,yl,il,Dl,p,El){const n=u,F=r;return d(),i(F,{frontmatter:p.frontmatter,data:p.data},{"main-content-md":o(()=>[s("div",A,[m,g,f,s("p",null,[l("评论区有人建议建一个群组讨论: "),e(n,{href:"https://t.me/kmuachat",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("@kmuachat")]),_:1})]),s("p",null,[l("本文只是我最初写 bot 时的一点笔记, 更建议你直接看 "),e(n,{href:"https://docs.python-telegram-bot.org",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("Python-Telegram-Bot")]),_:1}),l(" 的文档")])]),s("h2",C,[l("前言 "),e(n,{class:"header-anchor",href:"#前言","aria-label":'Permalink to "前言"'},{default:o(()=>[l("​")]),_:1})]),b,s("p",null,[l("在这篇文章中，将使用 "),e(n,{href:"https://docs.python-telegram-bot.org",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("Python-Telegram-Bot")]),_:1}),l(" ，基于 Python 的异步特性与 Telegram 友好开放的 API，开发一个兼顾实用性和趣味的 bot ，并使用 Docker 在任何地方部署 bot")]),s("p",null,[l("Demo: "),e(n,{href:"https://github.com/krau/kmua-bot",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("kmua-bot")]),_:1})]),k,h(" more "),s("h2",x,[l("准备 "),e(n,{class:"header-anchor",href:"#准备","aria-label":'Permalink to "准备"'},{default:o(()=>[l("​")]),_:1})]),s("h3",v,[l("环境搭建 "),e(n,{class:"header-anchor",href:"#环境搭建","aria-label":'Permalink to "环境搭建"'},{default:o(()=>[l("​")]),_:1})]),T,w,s("h3",P,[l("bot 申请 "),e(n,{class:"header-anchor",href:"#bot-申请","aria-label":'Permalink to "bot 申请"'},{default:o(()=>[l("​")]),_:1})]),s("p",null,[l("私聊 "),e(n,{href:"https://t.me/BotFather",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("@BotFather")]),_:1}),l("。发送 "),U,l("，根据提示一步步创建，记得妥善保存最后的 "),O,l("。")]),s("h3",H,[l("获取你的 id "),e(n,{class:"header-anchor",href:"#获取你的-id","aria-label":'Permalink to "获取你的 id"'},{default:o(()=>[l("​")]),_:1})]),s("p",null,[l("每个 tg 用户都有一串唯一标识，即为 "),N,l("，可以私聊 "),e(n,{href:"https://t.me/kmuav2bot",target:"_blank",rel:"noreferrer"},{default:o(()=>[l("@kmua")]),_:1}),l(" 发送 "),B,l(" 来获取它")]),s("h2",M,[l("编程 "),e(n,{class:"header-anchor",href:"#编程","aria-label":'Permalink to "编程"'},{default:o(()=>[l("​")]),_:1})]),s("h3",R,[l("开始:响应/start "),e(n,{class:"header-anchor",href:"#开始-响应-start","aria-label":'Permalink to "开始:响应/start"'},{default:o(()=>[l("​")]),_:1})]),$,Y,K,L,S,I,j,G,Z,q,V,W,X,z,Q,J,ss,ls,os,ns,es,s("h3",as,[l("授予群成员头衔 "),e(n,{class:"header-anchor",href:"#授予群成员头衔","aria-label":'Permalink to "授予群成员头衔"'},{default:o(()=>[l("​")]),_:1})]),ts,cs,ps,Fs,rs,ys,is,Ds,Es,ds,hs,us,_s,As,s("h3",ms,[l("响应未知命令 "),e(n,{class:"header-anchor",href:"#响应未知命令","aria-label":'Permalink to "响应未知命令"'},{default:o(()=>[l("​")]),_:1})]),gs,fs,Cs,bs,ks,xs,vs,Ts,ws,Ps,s("h3",Us,[l("简单的关键词回复 "),e(n,{class:"header-anchor",href:"#简单的关键词回复","aria-label":'Permalink to "简单的关键词回复"'},{default:o(()=>[l("​")]),_:1})]),Os,Hs,Ns,Bs,Ms,Rs,$s,Ys,Ks,Ls,Ss,Is,js,Gs,s("h2",Zs,[l("部署 "),e(n,{class:"header-anchor",href:"#部署","aria-label":'Permalink to "部署"'},{default:o(()=>[l("​")]),_:1})]),qs,s("h3",Vs,[l("Docker 本地构建 "),e(n,{class:"header-anchor",href:"#docker-本地构建","aria-label":'Permalink to "Docker 本地构建"'},{default:o(()=>[l("​")]),_:1})]),Ws,Xs,zs,Qs,Js,sl,s("h3",ll,[l("使用 GitHub action 自动构建 "),e(n,{class:"header-anchor",href:"#使用-github-action-自动构建","aria-label":'Permalink to "使用 GitHub action 自动构建"'},{default:o(()=>[l("​")]),_:1})]),ol,nl,el,al,tl,cl,pl,Fl]),"main-header":o(()=>[t(a.$slots,"main-header")]),"main-header-after":o(()=>[t(a.$slots,"main-header-after")]),"main-nav":o(()=>[t(a.$slots,"main-nav")]),"main-content":o(()=>[t(a.$slots,"main-content")]),"main-content-after":o(()=>[t(a.$slots,"main-content-after")]),"main-nav-before":o(()=>[t(a.$slots,"main-nav-before")]),"main-nav-after":o(()=>[t(a.$slots,"main-nav-after")]),comment:o(()=>[t(a.$slots,"comment")]),footer:o(()=>[t(a.$slots,"footer")]),aside:o(()=>[t(a.$slots,"aside")]),"aside-custom":o(()=>[t(a.$slots,"aside-custom")]),default:o(()=>[t(a.$slots,"default")]),_:3},8,["frontmatter","data"])}const gl=y(_,[["render",rl]]);export{c as data,gl as default};
