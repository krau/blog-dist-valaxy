import{_ as i}from"./ValaxyMain.vue_vue_type_style_index_0_lang-6a55f952.js";import{_ as D,p as y,c as d,w as l,o as F,b as e,d as s,e as a,a as A,r as t,f as C}from"./app-37ed1459.js";import"./YunFooter.vue_vue_type_script_setup_true_lang-67f0379b.js";import"./YunCard.vue_vue_type_style_index_0_lang-143ec6ad.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-febcad81.js";const L=JSON.parse('{"title":"FastAPI dependency injection system","description":"","frontmatter":{"title":"FastAPI dependency injection system","title_zh-CN":"FastAPI 依赖注入系统","date":"2023-03-15T13:30:34.000Z","updated":"2023-03-15T13:30:34.000Z","tags":["Python","代码","FastAPi"],"categories":["学习笔记"]},"headers":[{"level":2,"title":"什么是「依赖注入」","slug":"什么是「依赖注入」","link":"#什么是「依赖注入」","children":[]},{"level":2,"title":"What is \\"Dependency Injection\\"","slug":"what-is-dependency-injection","link":"#what-is-dependency-injection","children":[]},{"level":2,"title":"示例","slug":"示例","link":"#示例","children":[]},{"level":2,"title":"Examples","slug":"examples","link":"#examples","children":[{"level":3,"title":"函数作为依赖","slug":"函数作为依赖","link":"#函数作为依赖","children":[]},{"level":3,"title":"Function as dependence","slug":"function-as-dependence","link":"#function-as-dependence","children":[]},{"level":3,"title":"类作为依赖","slug":"类作为依赖","link":"#类作为依赖","children":[]},{"level":3,"title":"Class as dependence","slug":"class-as-dependence","link":"#class-as-dependence","children":[]},{"level":3,"title":"嵌套依赖","slug":"嵌套依赖","link":"#嵌套依赖","children":[]},{"level":3,"title":"nested dependencies","slug":"nested-dependencies","link":"#nested-dependencies","children":[]},{"level":3,"title":"路径装饰器依赖与全局依赖","slug":"路径装饰器依赖与全局依赖","link":"#路径装饰器依赖与全局依赖","children":[]},{"level":3,"title":"Path decorator dependencies and global dependencies","slug":"path-decorator-dependencies-and-global-dependencies","link":"#path-decorator-dependencies-and-global-dependencies","children":[]}]}],"relativePath":"pages/posts/fastapi-dependency-injection.md","path":"/home/runner/work/blog-source-valaxy/blog-source-valaxy/pages/posts/fastapi-dependency-injection.md","lastUpdated":1688467562000}'),c=JSON.parse('{"title":"FastAPI dependency injection system","description":"","frontmatter":{"title":"FastAPI dependency injection system","title_zh-CN":"FastAPI 依赖注入系统","date":"2023-03-15T13:30:34.000Z","updated":"2023-03-15T13:30:34.000Z","tags":["Python","代码","FastAPi"],"categories":["学习笔记"]},"headers":[{"level":2,"title":"什么是「依赖注入」","slug":"什么是「依赖注入」","link":"#什么是「依赖注入」","children":[]},{"level":2,"title":"What is \\"Dependency Injection\\"","slug":"what-is-dependency-injection","link":"#what-is-dependency-injection","children":[]},{"level":2,"title":"示例","slug":"示例","link":"#示例","children":[]},{"level":2,"title":"Examples","slug":"examples","link":"#examples","children":[{"level":3,"title":"函数作为依赖","slug":"函数作为依赖","link":"#函数作为依赖","children":[]},{"level":3,"title":"Function as dependence","slug":"function-as-dependence","link":"#function-as-dependence","children":[]},{"level":3,"title":"类作为依赖","slug":"类作为依赖","link":"#类作为依赖","children":[]},{"level":3,"title":"Class as dependence","slug":"class-as-dependence","link":"#class-as-dependence","children":[]},{"level":3,"title":"嵌套依赖","slug":"嵌套依赖","link":"#嵌套依赖","children":[]},{"level":3,"title":"nested dependencies","slug":"nested-dependencies","link":"#nested-dependencies","children":[]},{"level":3,"title":"路径装饰器依赖与全局依赖","slug":"路径装饰器依赖与全局依赖","link":"#路径装饰器依赖与全局依赖","children":[]},{"level":3,"title":"Path decorator dependencies and global dependencies","slug":"path-decorator-dependencies-and-global-dependencies","link":"#path-decorator-dependencies-and-global-dependencies","children":[]}]}],"relativePath":"pages/posts/fastapi-dependency-injection.md","path":"/home/runner/work/blog-source-valaxy/blog-source-valaxy/pages/posts/fastapi-dependency-injection.md","lastUpdated":1688467562000}'),m={name:"pages/posts/fastapi-dependency-injection.md",data(){return{data:c,frontmatter:c.frontmatter}},setup(){y("pageData",c)}},h={lang:"zh-CN",id:"什么是「依赖注入」",tabindex:"-1"},u={lang:"en",id:"what-is-dependency-injection",tabindex:"-1"},f=e("div",{lang:"zh-CN"},[e("blockquote",null,[e("p",null,"编程中的「依赖注入」是声明代码（本文中为路径操作函数 ）运行所需的，或要使用的「依赖」的一种方式。"),e("p",null,"然后，由系统（本文中为 FastAPI）负责执行任意需要的逻辑，为代码提供这些依赖（「注入」依赖项）。"),e("p",null,"依赖注入常用于以下场景："),e("ul",null,[e("li",null,"共享业务逻辑（复用相同的代码逻辑）"),e("li",null,"共享数据库连接"),e("li",null,"实现安全、验证、角色权限等……")]),e("p",null,"上述场景均可以使用依赖注入，将代码重复最小化。")])],-1),g=e("div",{lang:"en"},[e("blockquote",null,[e("p",null,'"Dependency Injection" means, in programming, that there is a way for your code (in this case, your path operation functions) to declare things that it requires to work and use: "dependencies".'),e("p",null,'And then, that system (in this case FastAPI) will take care of doing whatever is needed to provide your code with those needed dependencies ("inject" the dependencies).'),e("p",null,"This is very useful when you need to:"),e("ul",null,[e("li",null,"Have shared logic (the same code logic again and again)."),e("li",null,"Share database connections."),e("li",null,"Enforce security, authentication, role requirements, etc."),e("li",null,"And many other things...")]),e("p",null,"All these, while minimizing code repetition.")])],-1),_={lang:"zh-CN",id:"示例",tabindex:"-1"},v={lang:"en",id:"examples",tabindex:"-1"},b={lang:"zh-CN",id:"函数作为依赖",tabindex:"-1"},k={lang:"en",id:"function-as-dependence",tabindex:"-1"},P=e("div",{lang:"zh-CN"},[e("div",{class:"language-python"},[e("span",{class:"copy"}),e("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[e("code",null,[e("span",{class:"line"},[e("span",{style:{color:"#89DDFF","font-style":"italic"}},"from"),e("span",{style:{color:"#A6ACCD"}}," fastapi "),e("span",{style:{color:"#89DDFF","font-style":"italic"}},"import"),e("span",{style:{color:"#A6ACCD"}}," FastAPI"),e("span",{style:{color:"#89DDFF"}},","),e("span",{style:{color:"#A6ACCD"}}," Depends")]),s(`
`),e("span",{class:"line"}),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"app "),e("span",{style:{color:"#89DDFF"}},"="),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#82AAFF"}},"FastAPI"),e("span",{style:{color:"#89DDFF"}},"()")]),s(`
`),e("span",{class:"line"}),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#C792EA"}},"async"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#C792EA"}},"def"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#82AAFF"}},"common_parameters"),e("span",{style:{color:"#89DDFF"}},"("),e("span",{style:{color:"#A6ACCD","font-style":"italic"}},"q"),e("span",{style:{color:"#89DDFF"}},":"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#FFCB6B"}},"str"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"|"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"None"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"="),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"None,"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#A6ACCD","font-style":"italic"}},"page"),e("span",{style:{color:"#89DDFF"}},":"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#FFCB6B"}},"int"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"="),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#F78C6C"}},"1"),e("span",{style:{color:"#89DDFF"}},","),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#A6ACCD","font-style":"italic"}},"limit"),e("span",{style:{color:"#89DDFF"}},":"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#FFCB6B"}},"int"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"="),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#F78C6C"}},"10"),e("span",{style:{color:"#89DDFF"}},"):")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"    "),e("span",{style:{color:"#89DDFF","font-style":"italic"}},"return"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"{"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#C3E88D"}},"q"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#89DDFF"}},":"),e("span",{style:{color:"#A6ACCD"}}," q"),e("span",{style:{color:"#89DDFF"}},","),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#C3E88D"}},"page"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#89DDFF"}},":"),e("span",{style:{color:"#A6ACCD"}}," page"),e("span",{style:{color:"#89DDFF"}},","),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#C3E88D"}},"limit"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#89DDFF"}},":"),e("span",{style:{color:"#A6ACCD"}}," limit"),e("span",{style:{color:"#89DDFF"}},"}")]),s(`
`),e("span",{class:"line"}),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#89DDFF"}},"@"),e("span",{style:{color:"#82AAFF"}},"app"),e("span",{style:{color:"#89DDFF"}},"."),e("span",{style:{color:"#82AAFF"}},"get"),e("span",{style:{color:"#89DDFF"}},"("),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#C3E88D"}},"/dependency"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#89DDFF"}},")")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#C792EA"}},"async"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#C792EA"}},"def"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#82AAFF"}},"dependency"),e("span",{style:{color:"#89DDFF"}},"("),e("span",{style:{color:"#A6ACCD","font-style":"italic"}},"commons"),e("span",{style:{color:"#89DDFF"}},":"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#FFCB6B"}},"dict"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"="),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#82AAFF"}},"Depends"),e("span",{style:{color:"#89DDFF"}},"("),e("span",{style:{color:"#82AAFF"}},"common_parameters"),e("span",{style:{color:"#89DDFF"}},")):")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"    "),e("span",{style:{color:"#89DDFF","font-style":"italic"}},"return"),e("span",{style:{color:"#A6ACCD"}}," commons")]),s(`
`),e("span",{class:"line"})])])]),e("p",null,[e("code",null,"common_parameters"),s(" 函数定义了一组通用的查询参数"),e("code",null,"（q,page,limit）"),s("，该函数接受这些参数并返回一个字典，该字典包含这些参数及其值。这些参数之间可以通过逗号进行分隔，表示它们是可选参数，并且有默认值。")]),e("p",null,[e("code",null,'@app.get("/dependency")'),s(" 的路由装饰器绑定了一个API路由，这个路由接受一个名为 "),e("code",null,"commons"),s(" 的参数，这个参数需要调用 "),e("code",null,"common_parameters"),s(" 函数的返回值。Depends可以让我们把一个函数当做参数来传递到另一个函数，这里的 "),e("code",null,"Depends(common_parameters)"),s(" 表示该API路由需要调用 "),e("code",null,"common_parameters"),s(" 来获取查询参数。")]),e("p",null,[s("当请求到达API路由时，"),e("strong",null,[s("FastAPI将调用 "),e("code",null,"common_parameters"),s(" 函数，将返回的字典作为 "),e("code",null,"commons"),s(" 参数的值注入到 "),e("code",null,"dependency"),s(" 函数中")]),s("，然后执行处理请求的逻辑并返回响应。因此，"),e("strong",null,[e("code",null,"dependency"),s(" 的 "),e("code",null,"commons"),s(" 参数包含所有通用查询参数的值")]),s("，实现了依赖注入的功能。")]),e("p",null,"也就是说,通过依赖注入,我们使得一个代码块(函数)中可以调用另一个代码块,并访问其中的变量或属性"),e("div",{class:"tip custom-block"},[e("p",{class:"custom-block-title"},[e("span",{lang:"en"},"TIP"),e("span",{lang:"zh-CN"},"提示")]),e("p",null,"实际上,这里是实现了类似类的继承的功能,由于 FastAPI 是以函数式编程为主,所以才有了依赖注入系统,来实现类的一些功能."),e("p",null,[s("在上面的例子中，"),e("code",null,"common_parameters"),s(" 可以看作是一个公共的基类（类似于父类），它定义了一组通用的查询参数。同时，"),e("code",null,'@app.get("/dependency")'),s(" 中的函数可以看作是派生类（类似于子类），它需要使用通用查询参数来处理请求。")]),e("p",null,[s("当调用dependency函数时，"),e("code",null,"Depends"),s(" 会自动调用 "),e("code",null,"common_parameters"),s(" 函数，获取查询参数，然后将其注入到 "),e("code",null,"dependency"),s(" 函数中，类似于子类调用父类的构造函数获取公共配置，并继承其行为的方式。")]),e("p",null,"虽然Depends和依赖注入并不是类的继承，但它们可以实现类似的效果，使代码更加清晰和易于维护。")])],-1),E=e("div",{lang:"en"},[e("p",null,"The function common_parameters defines a set of common query parameters (q, page, limit) and accepts these parameters as input, then returns a dictionary containing these parameters and their values. These parameters can be separated by commas to indicate they are optional and have default values."),e("p",null,'The API route decorator @app.get("/dependency") binds an API route that accepts a parameter named commons, which needs to call the common_parameters function to get the query parameters. Depends allows us to pass a function as a parameter to another function. Here, the Depends(common_parameters) indicates that this API route needs to call common_parameters to get the query parameters.'),e("p",null,"When a request arrives at the API route, FastAPI will call the common_parameters function and inject the returned dictionary as the value of the commons parameter into the dependency function. Then, it executes the logic to handle the request and returns the response. Therefore, the commons parameter of the dependency function contains the values of all the common query parameters, achieving the functionality of dependency injection."),e("div",{class:"tip custom-block"},[e("p",{class:"custom-block-title"},[e("span",{lang:"en"},"TIP"),e("span",{lang:"zh-CN"},"提示")]),e("p",null,"In fact, here we are implementing a function similar to class inheritance. Since FastAPI is mainly based on functional programming, it has the dependency injection system to implement some functionality similar to class inheritance."),e("p",null,'In the example above, common_parameters can be seen as a common base class (similar to a parent class) that defines a set of common query parameters. At the same time, the function in @app.get("/dependency") can be seen as a derived class (similar to a child class) which needs to use the common query parameters to handle requests.'),e("p",null,"When calling the dependency function, Depends automatically calls common_parameters to get the query parameters and injects them into the dependency function, similar to calling the parent class constructor to get common configurations and inherit its behavior."),e("p",null,"Although Depends and dependency injection are not inheritance of classes, they can achieve similar effects, making the code more clear and easy to maintain.")])],-1),q={lang:"zh-CN",id:"类作为依赖",tabindex:"-1"},I={lang:"en",id:"class-as-dependence",tabindex:"-1"},w=e("div",{lang:"zh-CN"},[e("div",{class:"language-python"},[e("span",{class:"copy"}),e("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[e("code",null,[e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"fake_item_db "),e("span",{style:{color:"#89DDFF"}},"="),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"[{"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#C3E88D"}},"item"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#89DDFF"}},":"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#C3E88D"}},"foo"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#89DDFF"}},"},"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"{"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#C3E88D"}},"item"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#89DDFF"}},":"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#C3E88D"}},"qwq"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#89DDFF"}},"},"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"{"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#C3E88D"}},"item"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#89DDFF"}},":"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#C3E88D"}},"awa"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#89DDFF"}},"}]")]),s(`
`),e("span",{class:"line"}),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#C792EA"}},"class"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#FFCB6B"}},"CommonQueryParams"),e("span",{style:{color:"#89DDFF"}},":")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"    "),e("span",{style:{color:"#C792EA"}},"def"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#82AAFF"}},"__init__"),e("span",{style:{color:"#89DDFF"}},"("),e("span",{style:{color:"#F07178","font-style":"italic"}},"self"),e("span",{style:{color:"#89DDFF"}},","),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#A6ACCD","font-style":"italic"}},"q"),e("span",{style:{color:"#89DDFF"}},":"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#FFCB6B"}},"str"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"|"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"None"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"="),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"None,"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#A6ACCD","font-style":"italic"}},"page"),e("span",{style:{color:"#89DDFF"}},":"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#FFCB6B"}},"int"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"="),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#F78C6C"}},"1"),e("span",{style:{color:"#89DDFF"}},","),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#A6ACCD","font-style":"italic"}},"limit"),e("span",{style:{color:"#89DDFF"}},":"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#FFCB6B"}},"int"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"="),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#F78C6C"}},"100"),e("span",{style:{color:"#89DDFF"}},")"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"->"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"None:")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"        self"),e("span",{style:{color:"#89DDFF"}},"."),e("span",{style:{color:"#F07178"}},"q"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"="),e("span",{style:{color:"#A6ACCD"}}," q")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"        self"),e("span",{style:{color:"#89DDFF"}},"."),e("span",{style:{color:"#F07178"}},"page"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"="),e("span",{style:{color:"#A6ACCD"}}," page")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"        self"),e("span",{style:{color:"#89DDFF"}},"."),e("span",{style:{color:"#F07178"}},"limit"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"="),e("span",{style:{color:"#A6ACCD"}}," limit")]),s(`
`),e("span",{class:"line"}),s(`
`),e("span",{class:"line"}),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#89DDFF"}},"@"),e("span",{style:{color:"#82AAFF"}},"app"),e("span",{style:{color:"#89DDFF"}},"."),e("span",{style:{color:"#82AAFF"}},"get"),e("span",{style:{color:"#89DDFF"}},"("),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#C3E88D"}},"/classes_as_dependencies"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#89DDFF"}},")")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#C792EA"}},"async"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#C792EA"}},"def"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#82AAFF"}},"class_as_dependencies"),e("span",{style:{color:"#89DDFF"}},"("),e("span",{style:{color:"#A6ACCD","font-style":"italic"}},"commons"),e("span",{style:{color:"#89DDFF"}},"="),e("span",{style:{color:"#82AAFF"}},"Depends"),e("span",{style:{color:"#89DDFF"}},"("),e("span",{style:{color:"#82AAFF"}},"CommonQueryParams"),e("span",{style:{color:"#89DDFF"}},")):")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"    resp "),e("span",{style:{color:"#89DDFF"}},"="),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"{}")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"    "),e("span",{style:{color:"#89DDFF","font-style":"italic"}},"if"),e("span",{style:{color:"#A6ACCD"}}," commons"),e("span",{style:{color:"#89DDFF"}},"."),e("span",{style:{color:"#F07178"}},"q"),e("span",{style:{color:"#89DDFF"}},":")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"        resp"),e("span",{style:{color:"#89DDFF"}},"."),e("span",{style:{color:"#82AAFF"}},"update"),e("span",{style:{color:"#89DDFF"}},"({"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#C3E88D"}},"q"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#89DDFF"}},":"),e("span",{style:{color:"#82AAFF"}}," commons"),e("span",{style:{color:"#89DDFF"}},"."),e("span",{style:{color:"#F07178"}},"q"),e("span",{style:{color:"#89DDFF"}},"})")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"    items "),e("span",{style:{color:"#89DDFF"}},"="),e("span",{style:{color:"#A6ACCD"}}," fake_item_db"),e("span",{style:{color:"#89DDFF"}},"["),e("span",{style:{color:"#A6ACCD"}},"commons"),e("span",{style:{color:"#89DDFF"}},"."),e("span",{style:{color:"#F07178"}},"page"),e("span",{style:{color:"#89DDFF"}},":"),e("span",{style:{color:"#A6ACCD"}},"commons"),e("span",{style:{color:"#89DDFF"}},"."),e("span",{style:{color:"#F07178"}},"limit"),e("span",{style:{color:"#89DDFF"}},"]")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"    resp"),e("span",{style:{color:"#89DDFF"}},"."),e("span",{style:{color:"#82AAFF"}},"update"),e("span",{style:{color:"#89DDFF"}},"({"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#C3E88D"}},"items"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#89DDFF"}},":"),e("span",{style:{color:"#82AAFF"}}," items"),e("span",{style:{color:"#89DDFF"}},"})")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"    "),e("span",{style:{color:"#89DDFF","font-style":"italic"}},"return"),e("span",{style:{color:"#A6ACCD"}}," resp")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#676E95","font-style":"italic"}},"# 下面这两种写法也可以将类作为依赖")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#676E95","font-style":"italic"}},"# async def class_as_dependencies(commons:CommonQueryParams=Depends(CommonQueryParams))")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#676E95","font-style":"italic"}},"# async def class_as_dependencies(commons:CommonQueryParams=Depends())")]),s(`
`),e("span",{class:"line"})])])]),e("p",null,[s("当用户访问 "),e("code",null,"/classes_as_dependencies"),s(" 时，"),e("code",null,"CommonQueryParams"),s(" 依赖项会注入为 "),e("code",null,"commons"),s(" 参数。该端点然后检查请求中是否有指定搜索查询，并在有指定查询时使用它来更新 resp 字典。然后它根据 page 和 limit 参数从 fake_item_db 数据库检索项目，并返回一份带有搜索查询内容（如果有的话）和检索到的项目的响应。")])],-1),N=e("div",{lang:"en"},[e("div",{class:"language-python"},[e("span",{class:"copy"}),e("pre",{class:"shiki material-theme-palenight",tabindex:"0"},[e("code",null,[e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"fake_item_db "),e("span",{style:{color:"#89DDFF"}},"="),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"[{"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#C3E88D"}},"item"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#89DDFF"}},":"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#C3E88D"}},"foo"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#89DDFF"}},"},"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"{"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#C3E88D"}},"item"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#89DDFF"}},":"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#C3E88D"}},"qwq"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#89DDFF"}},"},"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"{"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#C3E88D"}},"item"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#89DDFF"}},":"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#C3E88D"}},"awa"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#89DDFF"}},"}]")]),s(`
`),e("span",{class:"line"}),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#C792EA"}},"class"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#FFCB6B"}},"CommonQueryParams"),e("span",{style:{color:"#89DDFF"}},":")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"    "),e("span",{style:{color:"#C792EA"}},"def"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#82AAFF"}},"__init__"),e("span",{style:{color:"#89DDFF"}},"("),e("span",{style:{color:"#F07178","font-style":"italic"}},"self"),e("span",{style:{color:"#89DDFF"}},","),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#A6ACCD","font-style":"italic"}},"q"),e("span",{style:{color:"#89DDFF"}},":"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#FFCB6B"}},"str"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"|"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"None"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"="),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"None,"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#A6ACCD","font-style":"italic"}},"page"),e("span",{style:{color:"#89DDFF"}},":"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#FFCB6B"}},"int"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"="),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#F78C6C"}},"1"),e("span",{style:{color:"#89DDFF"}},","),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#A6ACCD","font-style":"italic"}},"limit"),e("span",{style:{color:"#89DDFF"}},":"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#FFCB6B"}},"int"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"="),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#F78C6C"}},"100"),e("span",{style:{color:"#89DDFF"}},")"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"->"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"None:")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"        self"),e("span",{style:{color:"#89DDFF"}},"."),e("span",{style:{color:"#F07178"}},"q"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"="),e("span",{style:{color:"#A6ACCD"}}," q")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"        self"),e("span",{style:{color:"#89DDFF"}},"."),e("span",{style:{color:"#F07178"}},"page"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"="),e("span",{style:{color:"#A6ACCD"}}," page")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"        self"),e("span",{style:{color:"#89DDFF"}},"."),e("span",{style:{color:"#F07178"}},"limit"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"="),e("span",{style:{color:"#A6ACCD"}}," limit")]),s(`
`),e("span",{class:"line"}),s(`
`),e("span",{class:"line"}),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#89DDFF"}},"@"),e("span",{style:{color:"#82AAFF"}},"app"),e("span",{style:{color:"#89DDFF"}},"."),e("span",{style:{color:"#82AAFF"}},"get"),e("span",{style:{color:"#89DDFF"}},"("),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#C3E88D"}},"/classes_as_dependencies"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#89DDFF"}},")")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#C792EA"}},"async"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#C792EA"}},"def"),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#82AAFF"}},"class_as_dependencies"),e("span",{style:{color:"#89DDFF"}},"("),e("span",{style:{color:"#A6ACCD","font-style":"italic"}},"commons"),e("span",{style:{color:"#89DDFF"}},"="),e("span",{style:{color:"#82AAFF"}},"Depends"),e("span",{style:{color:"#89DDFF"}},"("),e("span",{style:{color:"#82AAFF"}},"CommonQueryParams"),e("span",{style:{color:"#89DDFF"}},")):")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"    resp "),e("span",{style:{color:"#89DDFF"}},"="),e("span",{style:{color:"#A6ACCD"}}," "),e("span",{style:{color:"#89DDFF"}},"{}")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"    "),e("span",{style:{color:"#89DDFF","font-style":"italic"}},"if"),e("span",{style:{color:"#A6ACCD"}}," commons"),e("span",{style:{color:"#89DDFF"}},"."),e("span",{style:{color:"#F07178"}},"q"),e("span",{style:{color:"#89DDFF"}},":")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"        resp"),e("span",{style:{color:"#89DDFF"}},"."),e("span",{style:{color:"#82AAFF"}},"update"),e("span",{style:{color:"#89DDFF"}},"({"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#C3E88D"}},"q"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#89DDFF"}},":"),e("span",{style:{color:"#82AAFF"}}," commons"),e("span",{style:{color:"#89DDFF"}},"."),e("span",{style:{color:"#F07178"}},"q"),e("span",{style:{color:"#89DDFF"}},"})")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"    items "),e("span",{style:{color:"#89DDFF"}},"="),e("span",{style:{color:"#A6ACCD"}}," fake_item_db"),e("span",{style:{color:"#89DDFF"}},"["),e("span",{style:{color:"#A6ACCD"}},"commons"),e("span",{style:{color:"#89DDFF"}},"."),e("span",{style:{color:"#F07178"}},"page"),e("span",{style:{color:"#89DDFF"}},":"),e("span",{style:{color:"#A6ACCD"}},"commons"),e("span",{style:{color:"#89DDFF"}},"."),e("span",{style:{color:"#F07178"}},"limit"),e("span",{style:{color:"#89DDFF"}},"]")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"    resp"),e("span",{style:{color:"#89DDFF"}},"."),e("span",{style:{color:"#82AAFF"}},"update"),e("span",{style:{color:"#89DDFF"}},"({"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#C3E88D"}},"items"),e("span",{style:{color:"#89DDFF"}},'"'),e("span",{style:{color:"#89DDFF"}},":"),e("span",{style:{color:"#82AAFF"}}," items"),e("span",{style:{color:"#89DDFF"}},"})")]),s(`
`),e("span",{class:"line"},[e("span",{style:{color:"#A6ACCD"}},"    "),e("span",{style:{color:"#89DDFF","font-style":"italic"}},"return"),e("span",{style:{color:"#A6ACCD"}}," resp")]),s(`
`),e("span",{class:"line"})])])]),e("p",null,"When a user accesses the /classes_as_dependencies endpoint, the CommonQueryParams dependency is injected as the commons parameter. The endpoint then checks if there is a search query specified in the request and updates the resp dictionary with the query if there is one. It then retrieves items from the fake_item_db database based on the page and limit parameters, and returns a response with the search query (if any) and the retrieved items.")],-1),j={lang:"zh-CN",id:"嵌套依赖",tabindex:"-1"},B={lang:"'en'",id:"nested-dependencies",tabindex:"-1"},x=e("div",{lang:"zh-CN"},[e("p",null,[s("依赖之间可以嵌套,"),e("strong",null,"一个依赖可以依赖于另一个依赖"),s(",即称为子依赖")])],-1),z={lang:"zh-CN",id:"路径装饰器依赖与全局依赖",tabindex:"-1"},$={lang:"en",id:"path-decorator-dependencies-and-global-dependencies",tabindex:"-1"},T=e("div",{lang:"zh-CN"},[e("p",null,"可以为 FastAPI 的路径装饰器传入 dependencies 参数,该参数的值是 Depend() 类列表 ,传入后可以在装饰器下的函数中调用依赖项"),e("p",null,"也可以在创建 FastAPI 或 APIRouter 实例时导入依赖,同样是传入 dependencies 参数,这样的依赖在整个应用下都可以调用")],-1),Q=e("div",{lang:"en"},[e("p",null,'You can pass the "dependencies" parameter to the path decorator of FastAPI, and the value of this parameter is a "Depend()" class list. After passing it, the dependencies can be called in the function under the decorator.'),e("p",null,'You can also import dependencies when creating FastAPI or APIRouter instances by passing the "dependencies" parameter. Such dependencies can be called throughout the entire application.')],-1);function S(n,W,V,Z,r,H){const o=C,p=i;return F(),d(p,{frontmatter:r.frontmatter,data:r.data},{"main-content-md":l(()=>[e("h2",h,[s("什么是「依赖注入」 "),a(o,{class:"header-anchor",href:"#什么是「依赖注入」","aria-hidden":"true"},{default:l(()=>[s("#")]),_:1})]),e("h2",u,[s('What is "Dependency Injection" '),a(o,{class:"header-anchor",href:"#what-is-dependency-injection","aria-hidden":"true"},{default:l(()=>[s("#")]),_:1})]),f,g,A(" more "),e("h2",_,[s("示例 "),a(o,{class:"header-anchor",href:"#示例","aria-hidden":"true"},{default:l(()=>[s("#")]),_:1})]),e("h2",v,[s("Examples "),a(o,{class:"header-anchor",href:"#examples","aria-hidden":"true"},{default:l(()=>[s("#")]),_:1})]),e("h3",b,[s("函数作为依赖 "),a(o,{class:"header-anchor",href:"#函数作为依赖","aria-hidden":"true"},{default:l(()=>[s("#")]),_:1})]),e("h3",k,[s("Function as dependence "),a(o,{class:"header-anchor",href:"#function-as-dependence","aria-hidden":"true"},{default:l(()=>[s("#")]),_:1})]),P,E,e("h3",q,[s("类作为依赖 "),a(o,{class:"header-anchor",href:"#类作为依赖","aria-hidden":"true"},{default:l(()=>[s("#")]),_:1})]),e("h3",I,[s("Class as dependence "),a(o,{class:"header-anchor",href:"#class-as-dependence","aria-hidden":"true"},{default:l(()=>[s("#")]),_:1})]),w,N,e("h3",j,[s("嵌套依赖 "),a(o,{class:"header-anchor",href:"#嵌套依赖","aria-hidden":"true"},{default:l(()=>[s("#")]),_:1})]),e("h3",B,[s("nested dependencies "),a(o,{class:"header-anchor",href:"#nested-dependencies","aria-hidden":"true"},{default:l(()=>[s("#")]),_:1})]),x,e("h3",z,[s("路径装饰器依赖与全局依赖 "),a(o,{class:"header-anchor",href:"#路径装饰器依赖与全局依赖","aria-hidden":"true"},{default:l(()=>[s("#")]),_:1})]),e("h3",$,[s("Path decorator dependencies and global dependencies "),a(o,{class:"header-anchor",href:"#path-decorator-dependencies-and-global-dependencies","aria-hidden":"true"},{default:l(()=>[s("#")]),_:1})]),T,Q]),"main-header":l(()=>[t(n.$slots,"main-header")]),"main-header-after":l(()=>[t(n.$slots,"main-header-after")]),"main-nav":l(()=>[t(n.$slots,"main-nav")]),"main-content":l(()=>[t(n.$slots,"main-content")]),"main-content-after":l(()=>[t(n.$slots,"main-content-after")]),"main-nav-before":l(()=>[t(n.$slots,"main-nav-before")]),"main-nav-after":l(()=>[t(n.$slots,"main-nav-after")]),comment:l(()=>[t(n.$slots,"comment")]),footer:l(()=>[t(n.$slots,"footer")]),aside:l(()=>[t(n.$slots,"aside")]),"aside-custom":l(()=>[t(n.$slots,"aside-custom")]),default:l(()=>[t(n.$slots,"default")]),_:3},8,["frontmatter","data"])}const M=D(m,[["render",S]]);export{L as __pageData,M as default};
