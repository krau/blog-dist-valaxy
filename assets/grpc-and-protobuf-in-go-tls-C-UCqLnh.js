import{_ as p}from"./ValaxyMain.vue_vue_type_style_index_0_lang-DBJlJlsu.js";import{c as d,w as h,u as g,a as D,p as n,o as y,e as o,d as a,f as i,g as s}from"./app-C3byl0xN.js";import"./YunFooter.vue_vue_type_script_setup_true_lang-DXCwL9V3.js";import"./YunCard.vue_vue_type_script_setup_true_lang-pMiCul1u.js";import"./index-C5okkQwF.js";import"./YunPageHeader.vue_vue_type_script_setup_true_lang-Dwg2FlTu.js";import"./post-CA0i77Wc.js";const E=i("h2",{id:"前言",tabindex:"-1"},[s("前言 "),i("a",{class:"header-anchor",href:"#前言","aria-label":'Permalink to "前言"'},"​")],-1),c=i("p",null,"为了保证 gRPC 服务不被第三方监听和调用, 防止通信被篡改或伪造, 需要对 gRPC 服务添加身份验证机制.",-1),C=i("p",null,"目前 gRPC 内置了三种身份验证机制:",-1),m=i("ul",null,[i("li",null,[i("strong",null,"SSL/TLS"),s(": gRPC 集成了 SSL/TLS, 提倡使用 SSL/TLS 对服务器进行身份验证, 并对客户端与服务器之间交换的所有数据进行加密。同时可选让客户端提供用于相互验证的证书.")]),i("li",null,[i("strong",null,"基于 Token 的身份验证"),s(": gRPC 提供了一种可将基于元数据的凭证附加到请求和响应中的机制. 这种机制必须与 SSL/TLS 同时使用, 以提供完整的身份验证和加密通信.")]),i("li",null,[i("strong",null,"ATLS"),s(": Google 自家的双向身份验证和传输安全系统, 通常也用于在 Google 家的平台上构建服务时.")])],-1),u=i("p",null,"本文介绍 gRPC 中的 SSL/TLS.",-1),A=i("div",{class:"tip custom-block"},[i("p",{class:"custom-block-title"},[i("span",{lang:"en"},"TIP"),i("span",{lang:"zh-CN"},"提示")]),i("p",null,"本文环境"),i("ul",null,[i("li",null,"Debian 12 amd64"),i("li",null,"Go 1.21.3")])],-1),f=i("h2",{id:"san-ca-和证书",tabindex:"-1"},[s("SAN, CA 和证书 "),i("a",{class:"header-anchor",href:"#san-ca-和证书","aria-label":'Permalink to "SAN, CA 和证书"'},"​")],-1),_=i("p",null,[s("使用 TLS 就需要证书. 在 Go 1.15 版本之后废弃了 "),i("code",null,"CommonName"),s(", 而是要使用 "),i("code",null,"Subject Alternative Name"),s(" (SAN) 来验证证书的有效性. 因此如果按照以前的方法生成证书, 大概率会导致下面的错误:")],-1),v=i("blockquote",null,[i("p",null,[i("code",null,'rpc error: code = Unavailable desc = connection error: desc = "transport: authentication handshake failed: x509: certificate relies on legacy Common Name field, use SANs or temporarily enable Common Name matching with GODEBUG=x509ignoreCN=0"')])],-1),b=i("p",null,"SAN 是 x509 定义中的一个扩展, 用于指定证书的使用范围. 使用了 SAN 扩展的证书, 可以在证书中指定多个域名或 IP 地址, 从而可以在一个证书中同时包含多个域名或 IP 地址.",-1),B=i("p",null,"CA (Certificate Authority), 即证书颁发机构, 用于管理和签发证书. 作用是检查证书持有者的合法性, 并颁发证书, 防止证书被伪造.",-1),N=i("p",null,"CA 自己也需要有证书, 称为根证书, 用于签发其他证书. 一般情况下, 根证书是自签名的, 即自己给自己签发证书. 根证书是信任链的起点, 有了根证书之后 CA 才能给其他人签发证书.",-1),P=i("p",null,"因此, 要想在 gRPC 中使用 TLS, 需要准备三组证书:",-1),S=i("ul",null,[i("li",null,"CA 根证书"),i("li",null,"服务端证书"),i("li",null,"客户端证书")],-1),x=i("h2",{id:"生成证书",tabindex:"-1"},[s("生成证书 "),i("a",{class:"header-anchor",href:"#生成证书","aria-label":'Permalink to "生成证书"'},"​")],-1),L=i("h3",{id:"生成-ca-证书",tabindex:"-1"},[s("生成 CA 证书 "),i("a",{class:"header-anchor",href:"#生成-ca-证书","aria-label":'Permalink to "生成 CA 证书"'},"​")],-1),T=i("p",null,[s("在任意目录下创建 "),i("code",null,"ca.conf"),s(" 文件:")],-1),R=i("div",{class:"language-ini vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"ini"),i("pre",{class:"shiki shiki-themes github-light material-theme-darker vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#89DDFF"}},"[ req ]")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F07178"}},"default_bits"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"       ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," 4096")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F07178"}},"distinguished_name"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," moe")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#89DDFF"}},"[ moe ]")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F07178"}},"countryName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"                 ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," GB")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F07178"}},"countryName_default"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"         ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," BeiJing")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F07178"}},"stateOrProvinceName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"         ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," State or Province Name (full name)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F07178"}},"stateOrProvinceName_default"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," BeiJing")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F07178"}},"localityName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"                ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," Locality Name (eg, city)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F07178"}},"localityName_default"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"        ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," NanJing")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F07178"}},"organizationName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"            ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," Organization Name (eg, company)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F07178"}},"organizationName_default"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"    ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," Kompany")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F07178"}},"commonName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"                  ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," krau.top")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F07178"}},"commonName_max"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"              ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," 64")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F07178"}},"commonName_default"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"          ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," krau.top")])])]),i("button",{class:"collapse"})],-1),w=i("p",null,"执行下面的命令生成 CA 私钥:",-1),$=i("div",{class:"language-bash vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light material-theme-darker vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"openssl"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}}," genrsa"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -out"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}}," ca.key"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#F78C6C"}}," 4096")])])]),i("button",{class:"collapse"})],-1),G=i("p",null,"然后生成 CA 证书:",-1),q=i("div",{class:"language-bash vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light material-theme-darker vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"openssl"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}}," req"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -new"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -x509"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -days"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#F78C6C"}}," 3650"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -key"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}}," ca.key"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -out"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}}," ca.crt"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -config"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}}," ca.conf")])])]),i("button",{class:"collapse"})],-1),O=i("p",null,[s("根据提示输入各种信息, 最后会生成 "),i("code",null,"ca.crt"),s(" 文件.")],-1),z=i("h3",{id:"生成服务端证书",tabindex:"-1"},[s("生成服务端证书 "),i("a",{class:"header-anchor",href:"#生成服务端证书","aria-label":'Permalink to "生成服务端证书"'},"​")],-1),J=i("p",null,[s("新建 "),i("code",null,"server.conf"),s(":")],-1),I=i("div",{class:"language-ini vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"ini"),i("pre",{class:"shiki shiki-themes github-light material-theme-darker vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#89DDFF"}},"[ req ]")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F07178"}},"default_bits"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"       ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," 2048")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F07178"}},"distinguished_name"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," moe")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#89DDFF"}},"[ moe ]")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F07178"}},"countryName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"                 ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," Country Name (2 letter code)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F07178"}},"countryName_default"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"         ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," CN")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F07178"}},"stateOrProvinceName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"         ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," State or Province Name (full name)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F07178"}},"stateOrProvinceName_default"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," JiangSu")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F07178"}},"localityName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"                ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," Locality Name (eg, city)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F07178"}},"localityName_default"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"        ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," NanJing")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F07178"}},"organizationName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"            ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," Organization Name (eg, company)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F07178"}},"organizationName_default"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"    ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," ovocom")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F07178"}},"commonName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"                  ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," CommonName (e.g. server FQDN or YOUR name)")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F07178"}},"commonName_max"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"              ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," 64")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F07178"}},"commonName_default"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"          ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," localhost "),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#545454","--shiki-light-font-style":"inherit","--shiki-dark-font-style":"italic"}},"# 此值应该包含在 [alt_names] 中")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#89DDFF"}},"[ req_ext ]")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F07178"}},"subjectAltName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}}," ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," @alt_names")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#89DDFF"}},"[alt_names]")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F07178"}},"DNS.1"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"   ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," localhost")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#F07178"}},"IP"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"      ="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," 127.0.0.1")])])]),i("button",{class:"collapse"})],-1),K=i("div",{class:"warning custom-block"},[i("p",{class:"custom-block-title"},[i("span",{lang:"en"},"WARNING"),i("span",{lang:"zh-CN"},"注意")]),i("p",null,[i("code",null,"commonName_default"),s(" 的值应该包含在 "),i("code",null,"[alt_names]"),s(" 中, 并且在连接时, 客户端的值需要与其匹配.")])],-1),V=i("p",null,"生成私钥:",-1),U=i("div",{class:"language-bash vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light material-theme-darker vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"openssl"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}}," genrsa"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -out"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}}," server.key"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#F78C6C"}}," 2048")])])]),i("button",{class:"collapse"})],-1),Z=i("p",null,"生成 csr:",-1),j=i("div",{class:"language-bash vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light material-theme-darker vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"openssl"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}}," req"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -new"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -key"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}}," server.key"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -out"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}}," server.csr"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -config"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}}," server.conf")])])]),i("button",{class:"collapse"})],-1),M=i("p",null,"请求 CA 签发证书:",-1),W=i("div",{class:"language-bash vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light material-theme-darker vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"openssl"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}}," x509"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -req"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -days"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#F78C6C"}}," 3650"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -in"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}}," server.csr"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -CA"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}}," ca.crt"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -CAkey"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}}," ca.key"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -CAcreateserial"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -out"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}}," server.crt"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -extensions"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}}," req_ext"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -extfile"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}}," server.conf")])])]),i("button",{class:"collapse"})],-1),X=i("h3",{id:"生成客户端证书",tabindex:"-1"},[s("生成客户端证书 "),i("a",{class:"header-anchor",href:"#生成客户端证书","aria-label":'Permalink to "生成客户端证书"'},"​")],-1),Q=i("p",null,"客户端不需要配置文件, 直接生成私钥:",-1),Y=i("div",{class:"language-bash vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light material-theme-darker vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"openssl"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}}," genrsa"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -out"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}}," client.key"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#F78C6C"}}," 2048")])])]),i("button",{class:"collapse"})],-1),H=i("p",null,"生成 csr:",-1),ii=i("div",{class:"language-bash vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light material-theme-darker vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"openssl"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}}," req"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -new"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -key"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}}," client.key"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -out"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}}," client.csr")])])]),i("button",{class:"collapse"})],-1),si=i("p",null,"请求 CA 签发证书:",-1),hi=i("div",{class:"language-bash vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"bash"),i("pre",{class:"shiki shiki-themes github-light material-theme-darker vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"openssl"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}}," x509"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -req"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -days"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#F78C6C"}}," 3650"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -in"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}}," client.csr"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -CA"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}}," ca.crt"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -CAkey"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}}," ca.key"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -CAcreateserial"),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#C3E88D"}}," -out"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}}," client.crt")])])]),i("button",{class:"collapse"})],-1),li=i("p",null,[s("现在已经准备好证书了. 服务端需要 "),i("code",null,"server.crt"),s(" 和 "),i("code",null,"server.key"),s(", 客户端需要 "),i("code",null,"client.crt"),s(" 和 "),i("code",null,"client.key"),s(". 此外, 两者都需要 "),i("code",null,"ca.crt"),s(".")],-1),ai=i("h2",{id:"实现",tabindex:"-1"},[s("实现 "),i("a",{class:"header-anchor",href:"#实现","aria-label":'Permalink to "实现"'},"​")],-1),ti=i("h3",{id:"服务端",tabindex:"-1"},[s("服务端 "),i("a",{class:"header-anchor",href:"#服务端","aria-label":'Permalink to "服务端"'},"​")],-1),ki=i("p",null,"关注高亮行",-1),ei=i("div",{class:"language-go vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"go"),i("pre",{class:"shiki shiki-themes github-light material-theme-darker vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}},"package"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}}," main")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF","--shiki-light-font-style":"inherit","--shiki-dark-font-style":"italic"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}}," (")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'	"'),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"crypto/tls"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'	"'),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"crypto/x509"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'	"'),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"net"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'	"'),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"os"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'    "'),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"fmt"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"')]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'	"'),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"google.golang.org/grpc"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'	"'),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"google.golang.org/grpc/credentials"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'    "'),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"example/proto"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},")")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}},"func"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#82AAFF"}}," main"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"()"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}}," {")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line highlighted"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"	pair"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},","),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," err "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}},":="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," tls"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#82AAFF"}},"LoadX509KeyPair"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}},"./server.crt"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},","),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},' "'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}},"./server.key"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF","--shiki-light-font-style":"inherit","--shiki-dark-font-style":"italic"}},"	if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," err "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}},"!="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#89DDFF"}}," nil"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"		fmt"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#82AAFF"}},"Printf"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}},"Failed to load certificates: "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#F07178"}},"%s"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},","),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," err"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF","--shiki-light-font-style":"inherit","--shiki-dark-font-style":"italic"}},"		return")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"	}")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line highlighted"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"	certPool "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}},":="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," x509"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#82AAFF"}},"NewCertPool"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"()")]),s(`
`),i("span",{class:"line highlighted"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"	ca"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},","),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," err "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}},":="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," os"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#82AAFF"}},"ReadFile"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}},"./ca.crt"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},")"),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#545454","--shiki-light-font-style":"inherit","--shiki-dark-font-style":"italic"}}," // 读取根证书")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF","--shiki-light-font-style":"inherit","--shiki-dark-font-style":"italic"}},"	if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," err "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}},"!="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#89DDFF"}}," nil"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"		fmt"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#82AAFF"}},"Printf"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}},"Failed to read ca certificate: "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#F07178"}},"%s"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},","),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," err"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF","--shiki-light-font-style":"inherit","--shiki-dark-font-style":"italic"}},"		return")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"	}")]),s(`
`),i("span",{class:"line highlighted"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF","--shiki-light-font-style":"inherit","--shiki-dark-font-style":"italic"}},"	if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," ok "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}},":="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," certPool"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#82AAFF"}},"AppendCertsFromPEM"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"("),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"ca"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},");"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}}," !"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"ok "),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"{")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"		fmt"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#82AAFF"}},"Println"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}},"Failed to append ca certificate"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF","--shiki-light-font-style":"inherit","--shiki-dark-font-style":"italic"}},"		return")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"	}")]),s(`
`),i("span",{class:"line highlighted"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"	creds "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}},":="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," credentials"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#82AAFF"}},"NewTLS"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}},"&"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"tls"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"Config"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"{")]),s(`
`),i("span",{class:"line highlighted"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"		Certificates"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},":"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}}," []"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"tls"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"Certificate"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"{"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"pair"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"},")]),s(`
`),i("span",{class:"line highlighted"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"		ClientAuth"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},":"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"   tls"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"RequireAndVerifyClientCert"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},",")]),s(`
`),i("span",{class:"line highlighted"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"		ClientCAs"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},":"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"    certPool"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},",")]),s(`
`),i("span",{class:"line highlighted"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"	})")]),s(`
`),i("span",{class:"line highlighted"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"	s "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}},":="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," grpc"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#82AAFF"}},"NewServer"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"("),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"grpc"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#82AAFF"}},"Creds"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"("),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"creds"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"))")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"	proto"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#82AAFF"}},"RegisterArtworkServiceServer"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"("),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"s"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},","),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}}," &"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"server"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"{})")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"	lis"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},","),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," err "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}},":="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," net"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#82AAFF"}},"Listen"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}},"tcp"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},","),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},' "'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}},":39010"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF","--shiki-light-font-style":"inherit","--shiki-dark-font-style":"italic"}},"    if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," err "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}},"!="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#89DDFF"}}," nil"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"        fmt"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#82AAFF"}},"Printf"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}},"Failed to listen: "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#F07178"}},"%s"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},","),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," err"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF","--shiki-light-font-style":"inherit","--shiki-dark-font-style":"italic"}},"        return")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"    }")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF","--shiki-light-font-style":"inherit","--shiki-dark-font-style":"italic"}},"	if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," err "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}},":="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," s"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#82AAFF"}},"Serve"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"("),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"lis"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},");"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," err "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}},"!="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#89DDFF"}}," nil"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"		fmt"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#82AAFF"}},"Printf"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}},"Failed to serve: "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#F07178"}},"%s"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},","),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," err"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF","--shiki-light-font-style":"inherit","--shiki-dark-font-style":"italic"}},"		return")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"	}")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"}")])])]),i("button",{class:"collapse"})],-1),ni=i("h3",{id:"客户端",tabindex:"-1"},[s("客户端 "),i("a",{class:"header-anchor",href:"#客户端","aria-label":'Permalink to "客户端"'},"​")],-1),Fi=i("p",null,"关注高亮行",-1),ri=i("div",{class:"language-go vp-adaptive-theme"},[i("button",{title:"Copy Code",class:"copy"}),i("span",{class:"lang"},"go"),i("pre",{class:"shiki shiki-themes github-light material-theme-darker vp-code"},[i("code",{"v-pre":""},[i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}},"package"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}}," main")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF","--shiki-light-font-style":"inherit","--shiki-dark-font-style":"italic"}},"import"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}}," (")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'	"'),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"crypto/tls"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'	"'),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"crypto/x509"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'	"'),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"os"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"')]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'	"'),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"example/proto"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'	"'),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"google.golang.org/grpc"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'	"'),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"google.golang.org/grpc/credentials"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"')]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},")")]),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"}),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}},"func"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#82AAFF"}}," main"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"()"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}}," {")]),s(`
`),i("span",{class:"line highlighted"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"	pair"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},","),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," err "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}},":="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," tls"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#82AAFF"}},"LoadX509KeyPair"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}},"./client.crt"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},","),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},' "'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}},"./client.key"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF","--shiki-light-font-style":"inherit","--shiki-dark-font-style":"italic"}},"	if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," err "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}},"!="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#89DDFF"}}," nil"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"		fmt"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#82AAFF"}},"Printf"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}},"Failed to load certificates: "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#F07178"}},"%s"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},","),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," err"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF","--shiki-light-font-style":"inherit","--shiki-dark-font-style":"italic"}},"		return")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"	}")]),s(`
`),i("span",{class:"line highlighted"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"	certPool "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}},":="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," x509"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#82AAFF"}},"NewCertPool"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"()")]),s(`
`),i("span",{class:"line highlighted"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"	ca"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},","),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," err "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}},":="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," os"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#82AAFF"}},"ReadFile"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}},"./ca.crt"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF","--shiki-light-font-style":"inherit","--shiki-dark-font-style":"italic"}},"	if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," err "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}},"!="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#89DDFF"}}," nil"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"        fmt"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#82AAFF"}},"Printf"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}},"Failed to read ca certificate: "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#F07178"}},"%s"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},","),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," err"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF","--shiki-light-font-style":"inherit","--shiki-dark-font-style":"italic"}},"		return")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"	}")]),s(`
`),i("span",{class:"line highlighted"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF","--shiki-light-font-style":"inherit","--shiki-dark-font-style":"italic"}},"	if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," ok "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}},":="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," certPool"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#82AAFF"}},"AppendCertsFromPEM"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"("),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"ca"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},");"),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}}," !"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"ok "),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"{")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"		fmt"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#82AAFF"}},"Println"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}},"Failed to append ca certificate"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},")"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"  ")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF","--shiki-light-font-style":"inherit","--shiki-dark-font-style":"italic"}},"		return")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"	}")]),s(`
`),i("span",{class:"line highlighted"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"	cred "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}},":="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," credentials"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#82AAFF"}},"NewTLS"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"("),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}},"&"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"tls"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"Config"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"{")]),s(`
`),i("span",{class:"line highlighted"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"		Certificates"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},":"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}}," []"),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"tls"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#FFCB6B"}},"Certificate"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"{"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"pair"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"},")]),s(`
`),i("span",{class:"line highlighted"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"		ServerName"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},":"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'   "'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}},"localhost"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},","),i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#545454","--shiki-light-font-style":"inherit","--shiki-dark-font-style":"italic"}}," // 服务端生成证书时的 commonName")]),s(`
`),i("span",{class:"line highlighted"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"		RootCAs"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},":"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"      certPool"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},",")]),s(`
`),i("span",{class:"line highlighted"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"	})")]),s(`
`),i("span",{class:"line highlighted"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"	conn"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},","),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," err "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}},":="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," grpc"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#82AAFF"}},"Dial"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}},"127.0.0.1:39010"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},","),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," grpc"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#82AAFF"}},"WithTransportCredentials"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"("),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"cred"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"))")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF","--shiki-light-font-style":"inherit","--shiki-dark-font-style":"italic"}},"	if"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," err "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}},"!="),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#89DDFF"}}," nil"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}}," {")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"		fmt"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#82AAFF"}},"Printf"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"("),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#C3E88D"}},"Failed to dial: "),i("span",{style:{"--shiki-light":"#005CC5","--shiki-dark":"#F07178"}},"%s"),i("span",{style:{"--shiki-light":"#032F62","--shiki-dark":"#89DDFF"}},'"'),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},","),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," err"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF","--shiki-light-font-style":"inherit","--shiki-dark-font-style":"italic"}},"		return")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"	}")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF","--shiki-light-font-style":"inherit","--shiki-dark-font-style":"italic"}},"	defer"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," conn"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#82AAFF"}},"Close"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"()")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"    client "),i("span",{style:{"--shiki-light":"#D73A49","--shiki-dark":"#89DDFF"}},":="),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}}," proto"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"."),i("span",{style:{"--shiki-light":"#6F42C1","--shiki-dark":"#82AAFF"}},"NewArtworkServiceClient"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"("),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#EEFFFF"}},"conn"),i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},")")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#6A737D","--shiki-dark":"#545454","--shiki-light-font-style":"inherit","--shiki-dark-font-style":"italic"}},"    // ...")]),s(`
`),i("span",{class:"line"},[i("span",{style:{"--shiki-light":"#24292E","--shiki-dark":"#89DDFF"}},"}")])])]),i("button",{class:"collapse"})],-1),pi=i("h2",{id:"参考",tabindex:"-1"},[s("参考 "),i("a",{class:"header-anchor",href:"#参考","aria-label":'Permalink to "参考"'},"​")],-1),di=i("ul",null,[i("li",null,[i("a",{href:"https://grpc.io/docs/guides/auth/",target:"_blank",rel:"noreferrer"},"gRPC Authentication")])],-1),fi={__name:"grpc-and-protobuf-in-go-tls",setup(gi,{expose:F}){const t=JSON.parse('{"title":"Go 的 gRPC 和 Protocol Buffers---TLS 认证","description":"","frontmatter":{"title":"Go 的 gRPC 和 Protocol Buffers---TLS 认证","date":"2023-10-23T09:29:29.000Z","updated":"2023-10-23T09:29:29.000Z","tags":["代码","Go","gRPC","Protobuf"],"categories":"小技术","hide":null,"author":"Krau","copyright":true,"icon":null,"cover":null,"color":"#79d4fd","comment":true,"end":false,"encrypt":false,"time_warning":false},"headers":[{"level":2,"title":"前言","slug":"前言","link":"#前言","children":[]},{"level":2,"title":"SAN, CA 和证书","slug":"san-ca-和证书","link":"#san-ca-和证书","children":[]},{"level":2,"title":"生成证书","slug":"生成证书","link":"#生成证书","children":[{"level":3,"title":"生成 CA 证书","slug":"生成-ca-证书","link":"#生成-ca-证书","children":[]},{"level":3,"title":"生成服务端证书","slug":"生成服务端证书","link":"#生成服务端证书","children":[]},{"level":3,"title":"生成客户端证书","slug":"生成客户端证书","link":"#生成客户端证书","children":[]}]},{"level":2,"title":"实现","slug":"实现","link":"#实现","children":[{"level":3,"title":"服务端","slug":"服务端","link":"#服务端","children":[]},{"level":3,"title":"客户端","slug":"客户端","link":"#客户端","children":[]}]},{"level":2,"title":"参考","slug":"参考","link":"#参考","children":[]}],"relativePath":"pages/posts/grpc-and-protobuf-in-go-tls.md","path":"/home/runner/work/blog-source-valaxy/blog-source-valaxy/pages/posts/grpc-and-protobuf-in-go-tls.md","lastUpdated":1719836457000}'),e=D(),k=t.frontmatter||{};return e.meta.frontmatter=Object.assign(e.meta.frontmatter||{},t.frontmatter||{}),n("pageData",t),n("valaxy:frontmatter",k),globalThis.$frontmatter=k,F({frontmatter:{title:"Go 的 gRPC 和 Protocol Buffers---TLS 认证",date:"2023-10-23T09:29:29.000Z",updated:"2023-10-23T09:29:29.000Z",tags:["代码","Go","gRPC","Protobuf"],categories:"小技术",hide:null,author:"Krau",copyright:!0,icon:null,cover:null,color:"#79d4fd",comment:!0,end:!1,encrypt:!1,time_warning:!1}}),(l,yi)=>{const r=p;return y(),d(r,{frontmatter:g(k)},{"main-content-md":h(()=>[E,c,C,m,u,o(" more "),A,f,_,v,b,B,N,P,S,x,L,T,R,w,$,G,q,O,z,J,I,K,V,U,Z,j,M,W,X,Q,Y,H,ii,si,hi,li,ai,ti,ki,ei,ni,Fi,ri,pi,di]),"main-header":h(()=>[a(l.$slots,"main-header")]),"main-header-after":h(()=>[a(l.$slots,"main-header-after")]),"main-nav":h(()=>[a(l.$slots,"main-nav")]),"main-content":h(()=>[a(l.$slots,"main-content")]),"main-content-after":h(()=>[a(l.$slots,"main-content-after")]),"main-nav-before":h(()=>[a(l.$slots,"main-nav-before")]),"main-nav-after":h(()=>[a(l.$slots,"main-nav-after")]),comment:h(()=>[a(l.$slots,"comment")]),footer:h(()=>[a(l.$slots,"footer")]),aside:h(()=>[a(l.$slots,"aside")]),"aside-custom":h(()=>[a(l.$slots,"aside-custom")]),default:h(()=>[a(l.$slots,"default")]),_:3},8,["frontmatter"])}}};export{fi as default};
